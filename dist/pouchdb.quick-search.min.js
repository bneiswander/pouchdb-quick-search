!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PouchQuickSearch=e()}(function(){return function n(i,o,s){function a(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return a(i[t][1][e]||e)},r,r.exports,n,i,o,s)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,u){!function(a){!function(){var s=e(28).default;u.once=function(t){var r=!1;return u.getArguments(function(e){if(r)throw console.trace(),new Error("once called  more than once");r=!0,t.apply(this,e)})},u.getArguments=function(n){return function(){for(var e=arguments.length,t=new Array(e),r=-1;++r<e;)t[r]=arguments[r];return n.call(this,t)}},u.toPromise=function(o){return u.getArguments(function(t){var r,i=this,n="function"==typeof t[t.length-1]&&t.pop(),e=(n&&(r=function(e,t){a.nextTick(function(){n(e,t)})}),new s(function(r,n){try{var e=u.once(function(e,t){e?n(e):r(t)});t.push(e),o.apply(i,t)}catch(e){n(e)}}));return r&&e.then(function(e){r(null,e)},r),e.cancel=function(){return this},e})},u.inherits=e(9),u.Promise=s,u.MD5=e(16),u.extend=e(23)}.call(this)}.call(this,e(32))},{16:16,23:23,28:28,32:32,9:9}],2:[function(e,t,r){t.exports=function(n){return function(){var e=arguments.length;if(e){for(var t=[],r=-1;++r<e;)t[r]=arguments[r];return n.call(this,t)}return n.call(this,[])}}},{}],3:[function(e,t,r){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};t.exports=n},{}],4:[function(e,t,r){var o,n;o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];0<e;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var t=[],r=0;r<e.length;r+=3)for(var n=e[r]<<16|e[r+1]<<8|e[r+2],i=0;i<4;i++)8*r+6*i<=8*e.length?t.push(o.charAt(n>>>6*(3-i)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],r=0,n=0;r<e.length;n=++r%4)0!=n&&t.push((o.indexOf(e.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|o.indexOf(e.charAt(r))>>>6-2*n);return t}},t.exports=n},{}],5:[function(e,t,i){function r(){var e;try{e=i.storage.debug}catch(e){}return e}(i=t.exports=e(6)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},i.formatArgs=function(){var t,r,e=arguments,n=this.useColors;return e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+i.humanize(this.diff),n&&(n="color: "+this.color,(e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1)))[r=t=0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(t++,"%c"===e)&&(r=t)}),e.splice(r,0,n)),e},i.save=function(e){try{null==e?i.storage.removeItem("debug"):i.storage.debug=e}catch(e){}},i.load=r,i.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},i.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:(()=>{try{return window.localStorage}catch(e){}})(),i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(e){return JSON.stringify(e)},i.enable(r())},{6:6}],6:[function(e,t,s){(s=t.exports=function(e){function t(){}function r(){var n=r,e=+new Date,t=e-(a||e),i=(n.diff=t,n.prev=a,n.curr=e,a=e,null==n.useColors&&(n.useColors=s.useColors()),null==n.color&&n.useColors&&(n.color=s.colors[u++%s.colors.length]),Array.prototype.slice.call(arguments)),o=(i[0]=s.coerce(i[0]),"string"!=typeof i[0]&&(i=["%o"].concat(i)),0);i[0]=i[0].replace(/%([a-z%])/g,function(e,t){var r;return"%%"!==e&&(o++,"function"==typeof(t=s.formatters[t]))&&(r=i[o],e=t.call(n,r),i.splice(o,1),o--),e}),"function"==typeof s.formatArgs&&(i=s.formatArgs.apply(n,i)),(r.log||s.log||console.log.bind(console)).apply(n,i)}t.enabled=!1,r.enabled=!0;var n=s.enabled(e)?r:t;return n.namespace=e,n}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},s.disable=function(){s.enable("")},s.enable=function(e){s.save(e);for(var t=(e||"").split(/[\s,]+/),r=t.length,n=0;n<r;n++)t[n]&&("-"===(e=t[n].replace(/\*/g,".*?"))[0]?s.skips.push(new RegExp("^"+e.substr(1)+"$")):s.names.push(new RegExp("^"+e+"$")))},s.enabled=function(e){var t,r;for(t=0,r=s.skips.length;t<r;t++)if(s.skips[t].test(e))return!1;for(t=0,r=s.names.length;t<r;t++)if(s.names[t].test(e))return!0;return!1},s.humanize=e(17),s.names=[],s.skips=[],s.formatters={};var a,u=0},{17:17}],7:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function u(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function l(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,i,o,s,a;if((this._events||(this._events={}),"error"===e)&&(!this._events.error||c(this._events.error)&&!this._events.error.length))throw(a=arguments[1])instanceof Error?a:((s=new Error('Uncaught, unspecified "error" event. ('+a+")")).context=a,s);if(l(t=this._events[e]))return!1;if(u(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),t.apply(this,n)}else if(c(t))for(n=Array.prototype.slice.call(arguments,1),r=(o=t.slice()).length,i=0;i<r;i++)o[i].apply(this,n);return!0},n.prototype.on=n.prototype.addListener=function(e,t){if(u(t))return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,u(t.listener)?t.listener:t),this._events[e]?c(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,c(this._events[e])&&!this._events[e].warned&&(t=l(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<t&&this._events[e].length>t&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace)&&console.trace(),this;throw TypeError("listener must be a function")},n.prototype.once=function(e,t){var r;if(u(t))return r=!1,n.listener=t,this.on(e,n),this;throw TypeError("listener must be a function");function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}},n.prototype.removeListener=function(e,t){var r,n,i,o;if(!u(t))throw TypeError("listener must be a function");if(this._events&&this._events[e])if(i=(r=this._events[e]).length,n=-1,r===t||u(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(c(r)){for(o=i;0<o--;)if(r[o]===t||r[o].listener&&r[o].listener===t){n=o;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(this._events)if(this._events.removeListener)if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);this.removeAllListeners("removeListener"),this._events={}}else{if(u(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);delete this._events[e]}else 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e];return this},n.prototype.listeners=function(e){e=this._events&&this._events[e]?u(this._events[e])?[this._events[e]]:this._events[e].slice():[];return e},n.prototype.listenerCount=function(e){if(this._events){e=this._events[e];if(u(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],8:[function(e,c,t){!function(u){!function(){var e,t,r,n,i=u.MutationObserver||u.WebKitMutationObserver,o=i?(e=0,i=new i(a),t=u.document.createTextNode(""),i.observe(t,{characterData:!0}),function(){t.data=e=++e%2}):u.setImmediate||void 0===u.MessageChannel?"document"in u&&"onreadystatechange"in u.document.createElement("script")?function(){var e=u.document.createElement("script");e.onreadystatechange=function(){a(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},u.document.documentElement.appendChild(e)}:function(){setTimeout(a,0)}:((r=new u.MessageChannel).port1.onmessage=a,function(){r.port2.postMessage(0)}),s=[];function a(){n=!0;for(var e,t,r=s.length;r;){for(t=s,s=[],e=-1;++e<r;)t[e]();r=s.length}n=!1}c.exports=function(e){1!==s.push(e)||n||o()}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){var r;t&&(e.super_=t,(r=function(){}).prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e)}},{}],10:[function(e,t,r){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(n(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))||!!e._isBuffer);var t}},{}],11:[function(e,t,r){var v="undefined"!=typeof JSON?JSON:e(12),m=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},b=Object.keys||function(e){var t,r=Object.prototype.hasOwnProperty||function(){return!0},n=[];for(t in e)r.call(e,t)&&n.push(t);return n};t.exports=function(e,t){var n,h=(t="function"==typeof(t=t||{})?{cmp:t}:t).space||"",d=("number"==typeof h&&(h=Array(h+1).join(" ")),"boolean"==typeof t.cycles&&t.cycles),p=t.replacer||function(e,t){return t},y=t.cmp&&(n=t.cmp,function(r){return function(e,t){e={key:e,value:r[e]};return n(e,{key:t,value:r[t]})}}),g=[];return function e(t,r,n,i){var o=h?"\n"+new Array(i+1).join(h):"",s=h?": ":":";if(n&&n.toJSON&&"function"==typeof n.toJSON&&(n=n.toJSON()),void 0!==(n=p.call(t,r,n))){if("object"!=typeof n||null===n)return v.stringify(n);if(m(n)){for(var a=[],u=0;u<n.length;u++){var c=e(n,u,n[u],i+1)||v.stringify(null);a.push(o+h+c)}return"["+a.join(",")+o+"]"}if(-1!==g.indexOf(n)){if(d)return v.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}g.push(n);for(var l=b(n).sort(y&&y(n)),a=[],u=0;u<l.length;u++){var f=e(n,r=l[u],n[r],i+1);f&&(f=v.stringify(r)+s+f,a.push(o+h+f))}return g.splice(g.indexOf(n),1),"{"+a.join(",")+o+"}"}}({"":e},"",e,0)}},{12:12}],12:[function(e,t,r){r.parse=e(13),r.stringify=e(14)},{13:13,14:14}],13:[function(e,t,r){var n,i,o,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function a(e){throw{name:"SyntaxError",message:e,at:n,text:o}}function u(e){return e&&e!==i&&a("Expected '"+e+"' instead of '"+i+"'"),i=o.charAt(n),n+=1,i}function c(){var e,t="";for("-"===i&&u(t="-");"0"<=i&&i<="9";)t+=i,u();if("."===i)for(t+=".";u()&&"0"<=i&&i<="9";)t+=i;if("e"===i||"E"===i)for(t+=i,u(),"-"!==i&&"+"!==i||(t+=i,u());"0"<=i&&i<="9";)t+=i,u();return e=Number(t),isFinite(e)||a("Bad number"),e}function l(){var e,t,r,n="";if('"'===i)for(;u();){if('"'===i)return u(),n;if("\\"===i)if(u(),"u"===i){for(t=r=0;t<4&&(e=parseInt(u(),16),isFinite(e));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else{if("string"!=typeof s[i])break;n+=s[i]}else n+=i}a("Bad string")}function f(){for(;i&&i<=" ";)u()}function h(){switch(f(),i){case"{":var e,t={};if("{"===i){if(u("{"),f(),"}"===i)return u("}"),t;for(;i;){if(e=l(),f(),u(":"),Object.prototype.hasOwnProperty.call(t,e)&&a('Duplicate key "'+e+'"'),t[e]=h(),f(),"}"===i)return u("}"),t;u(","),f()}}return void a("Bad object");case"[":var r=[];if("["===i){if(u("["),f(),"]"===i)return u("]"),r;for(;i;){if(r.push(h()),f(),"]"===i)return u("]"),r;u(","),f()}}return void a("Bad array");case'"':return l();case"-":return c();default:return("0"<=i&&i<="9"?c:()=>{switch(i){case"t":return u("t"),u("r"),u("u"),u("e"),!0;case"f":return u("f"),u("a"),u("l"),u("s"),u("e"),!1;case"n":return u("n"),u("u"),u("l"),u("l"),null;default:a("Unexpected '"+i+"'")}})()}}t.exports=function(e,s){return o=e,n=0,i=" ",e=h(),f(),i&&a("Syntax error"),"function"==typeof s?function e(t,r){var n,i,o=t[r];if(o&&"object"==typeof o)for(n in h)Object.prototype.hasOwnProperty.call(o,n)&&(void 0===(i=e(o,n))?delete o[n]:o[n]=i);return s.call(t,r,o)}({"":e},""):e}},{}],14:[function(e,t,r){var l,f,h,n=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function d(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}t.exports=function(e,t,r){var n;if(f=l="","number"==typeof r)for(n=0;n<r;n+=1)f+=" ";else"string"==typeof r&&(f=r);if(!(h=t)||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return function e(t,r){var n,i,o,s,a,u=l,c=r[t];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(t)),typeof(c="function"==typeof h?h.call(r,t,c):c)){case"string":return d(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(l+=f,a=[],"[object Array]"===Object.prototype.toString.apply(c)){for(s=c.length,n=0;n<s;n+=1)a[n]=e(n,c)||"null";o=0===a.length?"[]":l?"[\n"+l+a.join(",\n"+l)+"\n"+u+"]":"["+a.join(",")+"]"}else{if(h&&"object"==typeof h)for(s=h.length,n=0;n<s;n+=1)"string"==typeof(i=h[n])&&(o=e(i,c))&&a.push(d(i)+(l?": ":":")+o);else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(o=e(i,c))&&a.push(d(i)+(l?": ":":")+o);o=0===a.length?"{}":l?"{\n"+l+a.join(",\n"+l)+"\n"+u+"}":"{"+a.join(",")+"}"}return l=u,o}}("",{"":e});throw new Error("JSON.stringify")}},{}],15:[function(e,i,o){!function(){function N(e){var t=new N.Builder;return t.pipeline.add(N.trimmer,N.stopWordFilter,N.stemmer),t.searchPipeline.add(N.stemmer),e.call(t,t),t.build()}var t,c,l,e,f,h,d,p,y,g,v,m,b,w,_,x,k,S,E,O,A,T,L,I,r;function n(e){var t,r,n,i,o,s,a,u;return e.length<3||("y"==(u=e.substr(0,1))&&(e=u.toUpperCase()+e.substr(1)),s=g,(i=y).test(e)?e=e.replace(i,"$1$2"):s.test(e)&&(e=e.replace(s,"$1$2")),s=m,(i=v).test(e)?(a=i.exec(e),(i=f).test(a[1])&&(e=e.replace(i=b,""))):s.test(e)&&(o=(a=s.exec(e))[1],(s=p).test(o))&&(e=o,r=_,n=x,(s=w).test(e)?e+="e":r.test(e)?e=e.replace(i=b,""):n.test(e)&&(e+="e")),(i=k).test(e)&&(e=(o=(a=i.exec(e))[1])+"i"),(i=S).test(e)&&(o=(a=i.exec(e))[1],t=a[2],(i=f).test(o))&&(e=o+c[t]),(i=E).test(e)&&(o=(a=i.exec(e))[1],t=a[2],(i=f).test(o))&&(e=o+l[t]),s=A,(i=O).test(e)?(o=(a=i.exec(e))[1],(i=h).test(o)&&(e=o)):s.test(e)&&(o=(a=s.exec(e))[1]+a[2],(s=h).test(o))&&(e=o),(i=T).test(e)&&(o=(a=i.exec(e))[1],s=d,r=I,(i=h).test(o)||s.test(o)&&!r.test(o))&&(e=o),s=h,(i=L).test(e)&&s.test(e)&&(e=e.replace(i=b,"")),"y"==u&&(e=u.toLowerCase()+e.substr(1))),e}N.version="2.3.9",(N.utils={}).warn=(t=this,function(e){t.console&&console.warn&&console.warn(e)}),N.utils.asString=function(e){return null==e?"":e.toString()},N.utils.clone=function(e){if(null==e)return e;for(var t=Object.create(null),r=Object.keys(e),n=0;n<r.length;n++){var i=r[n],o=e[i];if(Array.isArray(o))t[i]=o.slice();else{if("string"!=typeof o&&"number"!=typeof o&&"boolean"!=typeof o)throw new TypeError("clone is not deep and does not support nested objects");t[i]=o}}return t},(N.FieldRef=function(e,t,r){this.docRef=e,this.fieldName=t,this._stringValue=r}).joiner="/",N.FieldRef.fromString=function(e){var t=e.indexOf(N.FieldRef.joiner);if(-1===t)throw"malformed field ref string";var r=e.slice(0,t),t=e.slice(t+1);return new N.FieldRef(t,r,e)},N.FieldRef.prototype.toString=function(){return null==this._stringValue&&(this._stringValue=this.fieldName+N.FieldRef.joiner+this.docRef),this._stringValue},(N.Set=function(e){if(this.elements=Object.create(null),e){this.length=e.length;for(var t=0;t<this.length;t++)this.elements[e[t]]=!0}else this.length=0}).complete={intersect:function(e){return e},union:function(){return this},contains:function(){return!0}},N.Set.empty={intersect:function(){return this},union:function(e){return e},contains:function(){return!1}},N.Set.prototype.contains=function(e){return!!this.elements[e]},N.Set.prototype.intersect=function(e){var t,r=[];if(e===N.Set.complete)return this;if(e===N.Set.empty)return e;for(var n=this.length<e.length?(t=this,e):(t=e,this),i=Object.keys(t.elements),o=0;o<i.length;o++){var s=i[o];s in n.elements&&r.push(s)}return new N.Set(r)},N.Set.prototype.union=function(e){return e===N.Set.complete?N.Set.complete:e===N.Set.empty?this:new N.Set(Object.keys(this.elements).concat(Object.keys(e.elements)))},N.idf=function(e,t){var r,n=0;for(r in e)"_index"!=r&&(n+=Object.keys(e[r]).length);return Math.log(1+Math.abs((t-n+.5)/(n+.5)))},(N.Token=function(e,t){this.str=e||"",this.metadata=t||{}}).prototype.toString=function(){return this.str},N.Token.prototype.update=function(e){return this.str=e(this.str,this.metadata),this},N.Token.prototype.clone=function(e){return new N.Token((e=e||function(e){return e})(this.str,this.metadata),this.metadata)},(N.tokenizer=function(e,t){if(null==e)return[];if(Array.isArray(e))return e.map(function(e){return new N.Token(N.utils.asString(e).toLowerCase(),N.utils.clone(t))});for(var r=e.toString().toLowerCase(),n=r.length,i=[],o=0,s=0;o<=n;o++){var a,u=o-s;!r.charAt(o).match(N.tokenizer.separator)&&o!=n||(0<u&&((a=N.utils.clone(t)||{}).position=[s,u],a.index=i.length,i.push(new N.Token(r.slice(s,o),a))),s=o+1)}return i}).separator=/[\s\-]+/,(N.Pipeline=function(){this._stack=[]}).registeredFunctions=Object.create(null),N.Pipeline.registerFunction=function(e,t){t in this.registeredFunctions&&N.utils.warn("Overwriting existing registered function: "+t),e.label=t,N.Pipeline.registeredFunctions[e.label]=e},N.Pipeline.warnIfFunctionNotRegistered=function(e){e.label&&e.label in this.registeredFunctions||N.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)},N.Pipeline.load=function(e){var r=new N.Pipeline;return e.forEach(function(e){var t=N.Pipeline.registeredFunctions[e];if(!t)throw new Error("Cannot load unregistered function: "+e);r.add(t)}),r},N.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(e){N.Pipeline.warnIfFunctionNotRegistered(e),this._stack.push(e)},this)},N.Pipeline.prototype.after=function(e,t){N.Pipeline.warnIfFunctionNotRegistered(t);e=this._stack.indexOf(e);if(-1==e)throw new Error("Cannot find existingFn");this._stack.splice(e+=1,0,t)},N.Pipeline.prototype.before=function(e,t){N.Pipeline.warnIfFunctionNotRegistered(t);e=this._stack.indexOf(e);if(-1==e)throw new Error("Cannot find existingFn");this._stack.splice(e,0,t)},N.Pipeline.prototype.remove=function(e){e=this._stack.indexOf(e);-1!=e&&this._stack.splice(e,1)},N.Pipeline.prototype.run=function(e){for(var t=this._stack.length,r=0;r<t;r++){for(var n=this._stack[r],i=[],o=0;o<e.length;o++){var s=n(e[o],o,e);if(null!=s&&""!==s)if(Array.isArray(s))for(var a=0;a<s.length;a++)i.push(s[a]);else i.push(s)}e=i}return e},N.Pipeline.prototype.runString=function(e,t){e=new N.Token(e,t);return this.run([e]).map(function(e){return e.toString()})},N.Pipeline.prototype.reset=function(){this._stack=[]},N.Pipeline.prototype.toJSON=function(){return this._stack.map(function(e){return N.Pipeline.warnIfFunctionNotRegistered(e),e.label})},(N.Vector=function(e){this._magnitude=0,this.elements=e||[]}).prototype.positionForIndex=function(e){if(0==this.elements.length)return 0;for(var t=0,r=this.elements.length/2,n=r-t,i=Math.floor(n/2),o=this.elements[2*i];1<n&&(o<e&&(t=i),e<o&&(r=i),o!=e);)n=r-t,i=t+Math.floor(n/2),o=this.elements[2*i];return o==e||e<o?2*i:o<e?2*(i+1):void 0},N.Vector.prototype.insert=function(e,t){this.upsert(e,t,function(){throw"duplicate index"})},N.Vector.prototype.upsert=function(e,t,r){this._magnitude=0;var n=this.positionForIndex(e);this.elements[n]==e?this.elements[n+1]=r(this.elements[n+1],t):this.elements.splice(n,0,e,t)},N.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var e=0,t=this.elements.length,r=1;r<t;r+=2){var n=this.elements[r];e+=n*n}return this._magnitude=Math.sqrt(e)},N.Vector.prototype.dot=function(e){for(var t,r,n=0,i=this.elements,o=e.elements,s=i.length,a=o.length,u=0,c=0;u<s&&c<a;)(t=i[u])<(r=o[c])?u+=2:r<t?c+=2:t==r&&(n+=i[u+1]*o[c+1],u+=2,c+=2);return n},N.Vector.prototype.similarity=function(e){return this.dot(e)/this.magnitude()||0},N.Vector.prototype.toArray=function(){for(var e=new Array(this.elements.length/2),t=1,r=0;t<this.elements.length;t+=2,r++)e[r]=this.elements[t];return e},N.Vector.prototype.toJSON=function(){return this.elements},c={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},l={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},e="[aeiouy]",r="[^aeiou][^aeiouy]*",f=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),h=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),d=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$"),p=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),y=/^(.+?)(ss|i)es$/,g=/^(.+?)([^s])s$/,v=/^(.+?)eed$/,m=/^(.+?)(ed|ing)$/,b=/.$/,w=/(at|bl|iz)$/,_=new RegExp("([^aeiouylsz])\\1$"),x=new RegExp("^"+r+e+"[^aeiouwxy]$"),k=/^(.+?[^aeiou])y$/,S=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,E=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,O=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,A=/^(.+?)(s|t)(ion)$/,T=/^(.+?)e$/,L=/ll$/,I=new RegExp("^"+r+e+"[^aeiouwxy]$"),N.Pipeline.registerFunction(N.stemmer=function(e){return e.update(n)},"stemmer"),N.stopWordFilter=(N.generateStopWordFilter=function(e){var t=e.reduce(function(e,t){return e[t]=t,e},{});return function(e){if(e&&t[e.toString()]!==e.toString())return e}})(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),N.Pipeline.registerFunction(N.stopWordFilter,"stopWordFilter"),N.Pipeline.registerFunction(N.trimmer=function(e){return e.update(function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"")})},"trimmer"),(N.TokenSet=function(){this.final=!1,this.edges={},this.id=N.TokenSet._nextId,N.TokenSet._nextId+=1})._nextId=1,N.TokenSet.fromArray=function(e){for(var t=new N.TokenSet.Builder,r=0,n=e.length;r<n;r++)t.insert(e[r]);return t.finish(),t.root},N.TokenSet.fromClause=function(e){return"editDistance"in e?N.TokenSet.fromFuzzyString(e.term,e.editDistance):N.TokenSet.fromString(e.term)},N.TokenSet.fromFuzzyString=function(e,t){for(var r=new N.TokenSet,n=[{node:r,editsRemaining:t,str:e}];n.length;){var i,o,s,a,u,c,l=n.pop();0<l.str.length&&((a=l.str.charAt(0))in l.node.edges?i=l.node.edges[a]:(i=new N.TokenSet,l.node.edges[a]=i),1==l.str.length&&(i.final=!0),n.push({node:i,editsRemaining:l.editsRemaining,str:l.str.slice(1)})),0!=l.editsRemaining&&("*"in l.node.edges?o=l.node.edges["*"]:(o=new N.TokenSet,l.node.edges["*"]=o),0==l.str.length&&(o.final=!0),n.push({node:o,editsRemaining:l.editsRemaining-1,str:l.str}),1<l.str.length&&n.push({node:l.node,editsRemaining:l.editsRemaining-1,str:l.str.slice(1)}),1==l.str.length&&(l.node.final=!0),1<=l.str.length&&("*"in l.node.edges?s=l.node.edges["*"]:(s=new N.TokenSet,l.node.edges["*"]=s),1==l.str.length&&(s.final=!0),n.push({node:s,editsRemaining:l.editsRemaining-1,str:l.str.slice(1)})),1<l.str.length)&&(a=l.str.charAt(0),(u=l.str.charAt(1))in l.node.edges?c=l.node.edges[u]:(c=new N.TokenSet,l.node.edges[u]=c),1==l.str.length&&(c.final=!0),n.push({node:c,editsRemaining:l.editsRemaining-1,str:a+l.str.slice(2)}))}return r},N.TokenSet.fromString=function(e){for(var t=new N.TokenSet,r=t,n=0,i=e.length;n<i;n++){var o,s=e[n],a=n==i-1;"*"==s?(t.edges[s]=t).final=a:((o=new N.TokenSet).final=a,t.edges[s]=o,t=o)}return r},N.TokenSet.prototype.toArray=function(){for(var e=[],t=[{prefix:"",node:this}];t.length;){var r=t.pop(),n=Object.keys(r.node.edges),i=n.length;r.node.final&&(r.prefix.charAt(0),e.push(r.prefix));for(var o=0;o<i;o++){var s=n[o];t.push({prefix:r.prefix.concat(s),node:r.node.edges[s]})}}return e},N.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var e=this.final?"1":"0",t=Object.keys(this.edges).sort(),r=t.length,n=0;n<r;n++)var i=t[n],e=e+i+this.edges[i].id;return e},N.TokenSet.prototype.intersect=function(e){for(var t=new N.TokenSet,r=void 0,n=[{qNode:e,output:t,node:this}];n.length;)for(var r=n.pop(),i=Object.keys(r.qNode.edges),o=i.length,s=Object.keys(r.node.edges),a=s.length,u=0;u<o;u++)for(var c=i[u],l=0;l<a;l++){var f,h,d,p,y=s[l];y!=c&&"*"!=c||(f=r.node.edges[y],h=r.qNode.edges[c],d=f.final&&h.final,p=void 0,y in r.output.edges?(p=r.output.edges[y]).final=p.final||d:((p=new N.TokenSet).final=d,r.output.edges[y]=p),n.push({qNode:h,output:p,node:f}))}return t},N.TokenSet.Builder=function(){this.previousWord="",this.root=new N.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},N.TokenSet.Builder.prototype.insert=function(e){var t=0;if(e<this.previousWord)throw new Error("Out of order word insertion");for(var r=0;r<e.length&&r<this.previousWord.length&&e[r]==this.previousWord[r];r++)t++;this.minimize(t);for(var n=0==this.uncheckedNodes.length?this.root:this.uncheckedNodes[this.uncheckedNodes.length-1].child,r=t;r<e.length;r++){var i=new N.TokenSet,o=e[r];n.edges[o]=i,this.uncheckedNodes.push({parent:n,char:o,child:i}),n=i}n.final=!0,this.previousWord=e},N.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},N.TokenSet.Builder.prototype.minimize=function(e){for(var t=this.uncheckedNodes.length-1;e<=t;t--){var r=this.uncheckedNodes[t],n=r.child.toString();n in this.minimizedNodes?r.parent.edges[r.char]=this.minimizedNodes[n]:(r.child._str=n,this.minimizedNodes[n]=r.child),this.uncheckedNodes.pop()}},(N.Index=function(e){this.invertedIndex=e.invertedIndex,this.fieldVectors=e.fieldVectors,this.tokenSet=e.tokenSet,this.fields=e.fields,this.pipeline=e.pipeline}).prototype.search=function(t){return this.query(function(e){new N.QueryParser(t,e).parse()})},N.Index.prototype.query=function(e){for(var t=new N.Query(this.fields),r=Object.create(null),n=Object.create(null),i=Object.create(null),o=Object.create(null),s=Object.create(null),a=0;a<this.fields.length;a++)n[this.fields[a]]=new N.Vector;e.call(t,t);for(a=0;a<t.clauses.length;a++){for(var u=t.clauses[a],c=null,l=N.Set.empty,c=u.usePipeline?this.pipeline.runString(u.term,{fields:u.fields}):[u.term],f=0;f<c.length;f++){var h=c[f],h=(u.term=h,N.TokenSet.fromClause(u)),d=this.tokenSet.intersect(h).toArray();if(0===d.length&&u.presence===N.Query.presence.REQUIRED){for(var p=0;p<u.fields.length;p++)o[O=u.fields[p]]=N.Set.empty;break}for(var y=0;y<d.length;y++)for(var g=d[y],v=this.invertedIndex[g],C=v._index,p=0;p<u.fields.length;p++){var m=v[O=u.fields[p]],b=Object.keys(m),w=g+"/"+O,_=new N.Set(b);if(u.presence==N.Query.presence.REQUIRED&&(l=l.union(_),void 0===o[O])&&(o[O]=N.Set.complete),u.presence==N.Query.presence.PROHIBITED)void 0===s[O]&&(s[O]=N.Set.empty),s[O]=s[O].union(_);else if(n[O].upsert(C,u.boost,function(e,t){return e+t}),!i[w]){for(var x=0;x<b.length;x++){var k,S=b[x],E=new N.FieldRef(S,O),S=m[S];void 0===(k=r[E])?r[E]=new N.MatchData(g,O,S):k.add(g,O,S)}i[w]=!0}}}if(u.presence===N.Query.presence.REQUIRED)for(p=0;p<u.fields.length;p++)o[O=u.fields[p]]=o[O].intersect(l)}for(var O,A=N.Set.complete,T=N.Set.empty,a=0;a<this.fields.length;a++)o[O=this.fields[a]]&&(A=A.intersect(o[O])),s[O]&&(T=T.union(s[O]));var L=Object.keys(r),I=[],j=Object.create(null);if(t.isNegated())for(L=Object.keys(this.fieldVectors),a=0;a<L.length;a++){var E=L[a],Q=N.FieldRef.fromString(E);r[E]=new N.MatchData}for(a=0;a<L.length;a++){var P,R,B=(Q=N.FieldRef.fromString(L[a])).docRef;!A.contains(B)||T.contains(B)||(P=this.fieldVectors[Q],P=n[Q.fieldName].similarity(P),void 0!==(R=j[B])?(R.score+=P,R.matchData.combine(r[Q])):(R={ref:B,score:P,matchData:r[Q]},j[B]=R,I.push(R)))}return I.sort(function(e,t){return t.score-e.score})},N.Index.prototype.toJSON=function(){var e=Object.keys(this.invertedIndex).sort().map(function(e){return[e,this.invertedIndex[e]]},this),t=Object.keys(this.fieldVectors).map(function(e){return[e,this.fieldVectors[e].toJSON()]},this);return{version:N.version,fields:this.fields,fieldVectors:t,invertedIndex:e,pipeline:this.pipeline.toJSON()}},N.Index.load=function(e){var t={},r={},n=e.fieldVectors,i=Object.create(null),o=e.invertedIndex,s=new N.TokenSet.Builder,a=N.Pipeline.load(e.pipeline);e.version!=N.version&&N.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+N.version+"' does not match serialized index '"+e.version+"'");for(var u=0;u<n.length;u++)r[(c=n[u])[0]]=new N.Vector(c[1]);for(u=0;u<o.length;u++){var c,l=(c=o[u])[0],f=c[1];s.insert(l),i[l]=f}return s.finish(),t.fields=e.fields,t.fieldVectors=r,t.invertedIndex=i,t.tokenSet=s.root,t.pipeline=a,new N.Index(t)},(N.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=N.tokenizer,this.pipeline=new N.Pipeline,this.searchPipeline=new N.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]}).prototype.ref=function(e){this._ref=e},N.Builder.prototype.field=function(e,t){if(/\//.test(e))throw new RangeError("Field '"+e+"' contains illegal character '/'");this._fields[e]=t||{}},N.Builder.prototype.b=function(e){this._b=e<0?0:1<e?1:e},N.Builder.prototype.k1=function(e){this._k1=e},N.Builder.prototype.add=function(e,t){var r=e[this._ref],n=Object.keys(this._fields);this._documents[r]=t||{},this.documentCount+=1;for(var i=0;i<n.length;i++){var o=n[i],s=this._fields[o].extractor,s=s?s(e):e[o],s=this.tokenizer(s,{fields:[o]}),a=this.pipeline.run(s),s=new N.FieldRef(r,o),u=Object.create(null);this.fieldTermFrequencies[s]=u,this.fieldLengths[s]=0,this.fieldLengths[s]+=a.length;for(var c=0;c<a.length;c++){var l=a[c];if(null==u[l]&&(u[l]=0),u[l]+=1,null==this.invertedIndex[l]){var f=Object.create(null);f._index=this.termIndex,this.termIndex+=1;for(var h=0;h<n.length;h++)f[n[h]]=Object.create(null);this.invertedIndex[l]=f}null==this.invertedIndex[l][o][r]&&(this.invertedIndex[l][o][r]=Object.create(null));for(var d=0;d<this.metadataWhitelist.length;d++){var p=this.metadataWhitelist[d],y=l.metadata[p];null==this.invertedIndex[l][o][r][p]&&(this.invertedIndex[l][o][r][p]=[]),this.invertedIndex[l][o][r][p].push(y)}}}},N.Builder.prototype.calculateAverageFieldLengths=function(){for(var e=Object.keys(this.fieldLengths),t=e.length,r={},n={},i=0;i<t;i++){var o=N.FieldRef.fromString(e[i]),s=o.fieldName;n[s]||(n[s]=0),n[s]+=1,r[s]||(r[s]=0),r[s]+=this.fieldLengths[o]}for(var a=Object.keys(this._fields),i=0;i<a.length;i++){var u=a[i];r[u]=r[u]/n[u]}this.averageFieldLength=r},N.Builder.prototype.createFieldVectors=function(){for(var e={},t=Object.keys(this.fieldTermFrequencies),r=t.length,n=Object.create(null),i=0;i<r;i++){for(var o=N.FieldRef.fromString(t[i]),s=o.fieldName,a=this.fieldLengths[o],u=new N.Vector,c=this.fieldTermFrequencies[o],l=Object.keys(c),f=l.length,h=this._fields[s].boost||1,d=this._documents[o.docRef].boost||1,p=0;p<f;p++){var y,g=l[p],v=c[g],m=this.invertedIndex[g]._index;void 0===n[g]?(y=N.idf(this.invertedIndex[g],this.documentCount),n[g]=y):y=n[g],g=(g=y*((this._k1+1)*v)/(this._k1*(1-this._b+this._b*(a/this.averageFieldLength[s]))+v))*h*d,v=Math.round(1e3*g)/1e3,u.insert(m,v)}e[o]=u}this.fieldVectors=e},N.Builder.prototype.createTokenSet=function(){this.tokenSet=N.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},N.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new N.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},N.Builder.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},(N.MatchData=function(e,t,r){for(var n=Object.create(null),i=Object.keys(r||{}),o=0;o<i.length;o++){var s=i[o];n[s]=r[s].slice()}this.metadata=Object.create(null),void 0!==e&&(this.metadata[e]=Object.create(null),this.metadata[e][t]=n)}).prototype.combine=function(e){for(var t=Object.keys(e.metadata),r=0;r<t.length;r++){var n=t[r],i=Object.keys(e.metadata[n]);null==this.metadata[n]&&(this.metadata[n]=Object.create(null));for(var o=0;o<i.length;o++){var s=i[o],a=Object.keys(e.metadata[n][s]);null==this.metadata[n][s]&&(this.metadata[n][s]=Object.create(null));for(var u=0;u<a.length;u++){var c=a[u];null==this.metadata[n][s][c]?this.metadata[n][s][c]=e.metadata[n][s][c]:this.metadata[n][s][c]=this.metadata[n][s][c].concat(e.metadata[n][s][c])}}}},N.MatchData.prototype.add=function(e,t,r){if(e in this.metadata)if(t in this.metadata[e])for(var n=Object.keys(r),i=0;i<n.length;i++){var o=n[i];o in this.metadata[e][t]?this.metadata[e][t][o]=this.metadata[e][t][o].concat(r[o]):this.metadata[e][t][o]=r[o]}else this.metadata[e][t]=r;else this.metadata[e]=Object.create(null),this.metadata[e][t]=r},(N.Query=function(e){this.clauses=[],this.allFields=e}).wildcard=new String("*"),N.Query.wildcard.NONE=0,N.Query.wildcard.LEADING=1,N.Query.wildcard.TRAILING=2,N.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},N.Query.prototype.clause=function(e){return"fields"in e||(e.fields=this.allFields),"boost"in e||(e.boost=1),"usePipeline"in e||(e.usePipeline=!0),"wildcard"in e||(e.wildcard=N.Query.wildcard.NONE),e.wildcard&N.Query.wildcard.LEADING&&e.term.charAt(0)!=N.Query.wildcard&&(e.term="*"+e.term),e.wildcard&N.Query.wildcard.TRAILING&&e.term.slice(-1)!=N.Query.wildcard&&(e.term=e.term+"*"),"presence"in e||(e.presence=N.Query.presence.OPTIONAL),this.clauses.push(e),this},N.Query.prototype.isNegated=function(){for(var e=0;e<this.clauses.length;e++)if(this.clauses[e].presence!=N.Query.presence.PROHIBITED)return!1;return!0},N.Query.prototype.term=function(e,t){var r;return Array.isArray(e)?e.forEach(function(e){this.term(e,N.utils.clone(t))},this):((r=t||{}).term=e.toString(),this.clause(r)),this},(N.QueryParseError=function(e,t,r){this.name="QueryParseError",this.message=e,this.start=t,this.end=r}).prototype=new Error,(N.QueryLexer=function(e){this.lexemes=[],this.str=e,this.length=e.length,this.pos=0,this.start=0,this.escapeCharPositions=[]}).prototype.run=function(){for(var e=N.QueryLexer.lexText;e;)e=e(this)},N.QueryLexer.prototype.sliceString=function(){for(var e,t=[],r=this.start,n=(this.pos,0);n<this.escapeCharPositions.length;n++)e=this.escapeCharPositions[n],t.push(this.str.slice(r,e)),r=e+1;return t.push(this.str.slice(r,this.pos)),this.escapeCharPositions.length=0,t.join("")},N.QueryLexer.prototype.emit=function(e){this.lexemes.push({type:e,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},N.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},N.QueryLexer.prototype.next=function(){var e;return this.pos>=this.length?N.QueryLexer.EOS:(e=this.str.charAt(this.pos),this.pos+=1,e)},N.QueryLexer.prototype.width=function(){return this.pos-this.start},N.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},N.QueryLexer.prototype.backup=function(){--this.pos},N.QueryLexer.prototype.acceptDigitRun=function(){for(var e,t;47<(t=(e=this.next()).charCodeAt(0))&&t<58;);e!=N.QueryLexer.EOS&&this.backup()},N.QueryLexer.prototype.more=function(){return this.pos<this.length},N.QueryLexer.EOS="EOS",N.QueryLexer.FIELD="FIELD",N.QueryLexer.TERM="TERM",N.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",N.QueryLexer.BOOST="BOOST",N.QueryLexer.PRESENCE="PRESENCE",N.QueryLexer.lexField=function(e){return e.backup(),e.emit(N.QueryLexer.FIELD),e.ignore(),N.QueryLexer.lexText},N.QueryLexer.lexTerm=function(e){if(1<e.width()&&(e.backup(),e.emit(N.QueryLexer.TERM)),e.ignore(),e.more())return N.QueryLexer.lexText},N.QueryLexer.lexEditDistance=function(e){return e.ignore(),e.acceptDigitRun(),e.emit(N.QueryLexer.EDIT_DISTANCE),N.QueryLexer.lexText},N.QueryLexer.lexBoost=function(e){return e.ignore(),e.acceptDigitRun(),e.emit(N.QueryLexer.BOOST),N.QueryLexer.lexText},N.QueryLexer.lexEOS=function(e){0<e.width()&&e.emit(N.QueryLexer.TERM)},N.QueryLexer.termSeparator=N.tokenizer.separator,N.QueryLexer.lexText=function(e){for(;;){var t=e.next();if(t==N.QueryLexer.EOS)return N.QueryLexer.lexEOS;if(92==t.charCodeAt(0))e.escapeCharacter();else{if(":"==t)return N.QueryLexer.lexField;if("~"==t)return e.backup(),0<e.width()&&e.emit(N.QueryLexer.TERM),N.QueryLexer.lexEditDistance;if("^"==t)return e.backup(),0<e.width()&&e.emit(N.QueryLexer.TERM),N.QueryLexer.lexBoost;if("+"==t&&1===e.width())return e.emit(N.QueryLexer.PRESENCE),N.QueryLexer.lexText;if("-"==t&&1===e.width())return e.emit(N.QueryLexer.PRESENCE),N.QueryLexer.lexText;if(t.match(N.QueryLexer.termSeparator))return N.QueryLexer.lexTerm}}},(N.QueryParser=function(e,t){this.lexer=new N.QueryLexer(e),this.query=t,this.currentClause={},this.lexemeIdx=0}).prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var e=N.QueryParser.parseClause;e;)e=e(this);return this.query},N.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},N.QueryParser.prototype.consumeLexeme=function(){var e=this.peekLexeme();return this.lexemeIdx+=1,e},N.QueryParser.prototype.nextClause=function(){var e=this.currentClause;this.query.clause(e),this.currentClause={}},N.QueryParser.parseClause=function(e){var t=e.peekLexeme();if(null!=t)switch(t.type){case N.QueryLexer.PRESENCE:return N.QueryParser.parsePresence;case N.QueryLexer.FIELD:return N.QueryParser.parseField;case N.QueryLexer.TERM:return N.QueryParser.parseTerm;default:var r="expected either a field or a term, found "+t.type;throw 1<=t.str.length&&(r+=" with value '"+t.str+"'"),new N.QueryParseError(r,t.start,t.end)}},N.QueryParser.parsePresence=function(e){var t=e.consumeLexeme();if(null!=t){switch(t.str){case"-":e.currentClause.presence=N.Query.presence.PROHIBITED;break;case"+":e.currentClause.presence=N.Query.presence.REQUIRED;break;default:var r="unrecognised presence operator'"+t.str+"'";throw new N.QueryParseError(r,t.start,t.end)}var n=e.peekLexeme();if(null==n)throw new N.QueryParseError(r="expecting term or field, found nothing",t.start,t.end);switch(n.type){case N.QueryLexer.FIELD:return N.QueryParser.parseField;case N.QueryLexer.TERM:return N.QueryParser.parseTerm;default:r="expecting term or field, found '"+n.type+"'";throw new N.QueryParseError(r,n.start,n.end)}}},N.QueryParser.parseField=function(e){var t=e.consumeLexeme();if(null!=t){if(-1==e.query.allFields.indexOf(t.str))throw r=e.query.allFields.map(function(e){return"'"+e+"'"}).join(", "),r="unrecognised field '"+t.str+"', possible fields: "+r,new N.QueryParseError(r,t.start,t.end);e.currentClause.fields=[t.str];e=e.peekLexeme();if(null==e)throw new N.QueryParseError(r="expecting term, found nothing",t.start,t.end);if(e.type===N.QueryLexer.TERM)return N.QueryParser.parseTerm;var r="expecting term, found '"+e.type+"'";throw new N.QueryParseError(r,e.start,e.end)}},N.QueryParser.parseTerm=function(e){var t=e.consumeLexeme();if(null!=t){e.currentClause.term=t.str.toLowerCase(),-1!=t.str.indexOf("*")&&(e.currentClause.usePipeline=!1);var r=e.peekLexeme();if(null==r)e.nextClause();else switch(r.type){case N.QueryLexer.TERM:return e.nextClause(),N.QueryParser.parseTerm;case N.QueryLexer.FIELD:return e.nextClause(),N.QueryParser.parseField;case N.QueryLexer.EDIT_DISTANCE:return N.QueryParser.parseEditDistance;case N.QueryLexer.BOOST:return N.QueryParser.parseBoost;case N.QueryLexer.PRESENCE:return e.nextClause(),N.QueryParser.parsePresence;default:var n="Unexpected lexeme type '"+r.type+"'";throw new N.QueryParseError(n,r.start,r.end)}}},N.QueryParser.parseEditDistance=function(e){var t=e.consumeLexeme();if(null!=t){var r=parseInt(t.str,10);if(isNaN(r))throw new N.QueryParseError(i="edit distance must be numeric",t.start,t.end);e.currentClause.editDistance=r;var n=e.peekLexeme();if(null==n)e.nextClause();else switch(n.type){case N.QueryLexer.TERM:return e.nextClause(),N.QueryParser.parseTerm;case N.QueryLexer.FIELD:return e.nextClause(),N.QueryParser.parseField;case N.QueryLexer.EDIT_DISTANCE:return N.QueryParser.parseEditDistance;case N.QueryLexer.BOOST:return N.QueryParser.parseBoost;case N.QueryLexer.PRESENCE:return e.nextClause(),N.QueryParser.parsePresence;default:var i="Unexpected lexeme type '"+n.type+"'";throw new N.QueryParseError(i,n.start,n.end)}}},N.QueryParser.parseBoost=function(e){var t=e.consumeLexeme();if(null!=t){var r=parseInt(t.str,10);if(isNaN(r))throw new N.QueryParseError(i="boost must be numeric",t.start,t.end);e.currentClause.boost=r;var n=e.peekLexeme();if(null==n)e.nextClause();else switch(n.type){case N.QueryLexer.TERM:return e.nextClause(),N.QueryParser.parseTerm;case N.QueryLexer.FIELD:return e.nextClause(),N.QueryParser.parseField;case N.QueryLexer.EDIT_DISTANCE:return N.QueryParser.parseEditDistance;case N.QueryLexer.BOOST:return N.QueryParser.parseBoost;case N.QueryLexer.PRESENCE:return e.nextClause(),N.QueryParser.parsePresence;default:var i="Unexpected lexeme type '"+n.type+"'";throw new N.QueryParseError(i,n.start,n.end)}}},r=this,"object"==typeof o?i.exports=N:r.lunr=N}()},{}],16:[function(e,t,r){function g(e,t){e.constructor==String?e=(t&&"binary"===t.encoding?w:m).stringToBytes(e):b(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=v.bytesToWords(e),t=8*e.length,n=1732584193,i=-271733879,o=-1732584194,s=271733878,a=0;a<r.length;a++)r[a]=16711935&(r[a]<<8|r[a]>>>24)|4278255360&(r[a]<<24|r[a]>>>8);r[t>>>5]|=128<<t%32,r[14+(64+t>>>9<<4)]=t;for(var u=g._ff,c=g._gg,l=g._hh,f=g._ii,a=0;a<r.length;a+=16){var h=n,d=i,p=o,y=s,n=u(n,i,o,s,r[a+0],7,-680876936),s=u(s,n,i,o,r[a+1],12,-389564586),o=u(o,s,n,i,r[a+2],17,606105819),i=u(i,o,s,n,r[a+3],22,-1044525330);n=u(n,i,o,s,r[a+4],7,-176418897),s=u(s,n,i,o,r[a+5],12,1200080426),o=u(o,s,n,i,r[a+6],17,-1473231341),i=u(i,o,s,n,r[a+7],22,-45705983),n=u(n,i,o,s,r[a+8],7,1770035416),s=u(s,n,i,o,r[a+9],12,-1958414417),o=u(o,s,n,i,r[a+10],17,-42063),i=u(i,o,s,n,r[a+11],22,-1990404162),n=u(n,i,o,s,r[a+12],7,1804603682),s=u(s,n,i,o,r[a+13],12,-40341101),o=u(o,s,n,i,r[a+14],17,-1502002290),n=c(n,i=u(i,o,s,n,r[a+15],22,1236535329),o,s,r[a+1],5,-165796510),s=c(s,n,i,o,r[a+6],9,-1069501632),o=c(o,s,n,i,r[a+11],14,643717713),i=c(i,o,s,n,r[a+0],20,-373897302),n=c(n,i,o,s,r[a+5],5,-701558691),s=c(s,n,i,o,r[a+10],9,38016083),o=c(o,s,n,i,r[a+15],14,-660478335),i=c(i,o,s,n,r[a+4],20,-405537848),n=c(n,i,o,s,r[a+9],5,568446438),s=c(s,n,i,o,r[a+14],9,-1019803690),o=c(o,s,n,i,r[a+3],14,-187363961),i=c(i,o,s,n,r[a+8],20,1163531501),n=c(n,i,o,s,r[a+13],5,-1444681467),s=c(s,n,i,o,r[a+2],9,-51403784),o=c(o,s,n,i,r[a+7],14,1735328473),n=l(n,i=c(i,o,s,n,r[a+12],20,-1926607734),o,s,r[a+5],4,-378558),s=l(s,n,i,o,r[a+8],11,-2022574463),o=l(o,s,n,i,r[a+11],16,1839030562),i=l(i,o,s,n,r[a+14],23,-35309556),n=l(n,i,o,s,r[a+1],4,-1530992060),s=l(s,n,i,o,r[a+4],11,1272893353),o=l(o,s,n,i,r[a+7],16,-155497632),i=l(i,o,s,n,r[a+10],23,-1094730640),n=l(n,i,o,s,r[a+13],4,681279174),s=l(s,n,i,o,r[a+0],11,-358537222),o=l(o,s,n,i,r[a+3],16,-722521979),i=l(i,o,s,n,r[a+6],23,76029189),n=l(n,i,o,s,r[a+9],4,-640364487),s=l(s,n,i,o,r[a+12],11,-421815835),o=l(o,s,n,i,r[a+15],16,530742520),n=f(n,i=l(i,o,s,n,r[a+2],23,-995338651),o,s,r[a+0],6,-198630844),s=f(s,n,i,o,r[a+7],10,1126891415),o=f(o,s,n,i,r[a+14],15,-1416354905),i=f(i,o,s,n,r[a+5],21,-57434055),n=f(n,i,o,s,r[a+12],6,1700485571),s=f(s,n,i,o,r[a+3],10,-1894986606),o=f(o,s,n,i,r[a+10],15,-1051523),i=f(i,o,s,n,r[a+1],21,-2054922799),n=f(n,i,o,s,r[a+8],6,1873313359),s=f(s,n,i,o,r[a+15],10,-30611744),o=f(o,s,n,i,r[a+6],15,-1560198380),i=f(i,o,s,n,r[a+13],21,1309151649),n=f(n,i,o,s,r[a+4],6,-145523070),s=f(s,n,i,o,r[a+11],10,-1120210379),o=f(o,s,n,i,r[a+2],15,718787259),i=f(i,o,s,n,r[a+9],21,-343485551),n=n+h>>>0,i=i+d>>>0,o=o+p>>>0,s=s+y>>>0}return v.endian([n,i,o,s])}var v,m,b,w;v=e(4),m=e(3).utf8,b=e(10),w=e(3).bin,g._ff=function(e,t,r,n,i,o,s){e=e+(t&r|~t&n)+(i>>>0)+s;return(e<<o|e>>>32-o)+t},g._gg=function(e,t,r,n,i,o,s){e=e+(t&n|r&~n)+(i>>>0)+s;return(e<<o|e>>>32-o)+t},g._hh=function(e,t,r,n,i,o,s){e=e+(t^r^n)+(i>>>0)+s;return(e<<o|e>>>32-o)+t},g._ii=function(e,t,r,n,i,o,s){e=e+(r^(t|~n))+(i>>>0)+s;return(e<<o|e>>>32-o)+t},g._blocksize=16,g._digestsize=16,t.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);e=v.wordsToBytes(g(e,t));return t&&t.asBytes?e:t&&t.asString?w.bytesToString(e):v.bytesToHex(e)}},{10:10,3:3,4:4}],17:[function(e,t,r){var i=36e5,o=864e5;function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}t.exports=function(e,t){if(t=t||{},"string"==typeof e){var r=e;if(!(1e4<(r=""+r).length)){r=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(r);if(r){var n=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}else return t.long?s(r=e,o,"day")||s(r,i,"hour")||s(r,6e4,"minute")||s(r,1e3,"second")||r+" ms":o<=(t=e)?Math.round(t/o)+"d":i<=t?Math.round(t/i)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms"}},{}],18:[function(e,t,r){function i(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,i=0;i<n;i++)t+=String.fromCharCode(r[i]);return t}Object.defineProperty(r,"__esModule",{value:!0});function n(e){return atob(e)}function o(e){return btoa(e)}function s(t,r){t=t||[],r=r||{};try{return new Blob(t,r)}catch(e){if("TypeError"!==e.name)throw e;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(r.type)}}function a(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;i<t;i++)n[i]=e.charCodeAt(i);return r}function u(e,t){return s([a(e)],{type:t})}function c(e,t){if("undefined"==typeof FileReader)return t(i((new FileReaderSync).readAsArrayBuffer(e)));var r=new FileReader,n="function"==typeof r.readAsBinaryString;r.onloadend=function(e){e=e.target.result||"";if(n)return t(e);t(i(e))},n?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}r.arrayBufferToBase64=function(e){return o(i(e))},r.arrayBufferToBinaryString=i,r.atob=n,r.btoa=o,r.base64StringToBlobOrBuffer=function(e,t){return u(n(e),t)},r.binaryStringToArrayBuffer=a,r.binaryStringToBlobOrBuffer=u,r.blob=s,r.blobOrBufferToBase64=function(e,t){c(e,function(e){t(o(e))})},r.readAsArrayBuffer=function(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var r=new FileReader;r.onloadend=function(e){e=e.target.result||new ArrayBuffer(0);t(e)},r.readAsArrayBuffer(e)},r.readAsBinaryString=c,r.typedBuffer=function(){}},{}],19:[function(e,t,l){var d=-324,p=3,f="",h=e(20);function r(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":var t,r,n,i=e;return 0===i?"1":(t=i.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=(i=i<0)?"0":"2",n=(i?-n:n)-d,n=h.padLeft(n.toString(),"0",p),r+=f+n,n=Math.abs(parseFloat(t[0])),t=(t=(n=i?10-n:n).toFixed(20)).replace(/\.?0+$/,""),r+=f+t);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var i=Array.isArray(e),o=i?e:Object.keys(e),s=-1,a=o.length,u="";if(i)for(;++s<a;)u+=l.toIndexableString(o[s]);else for(;++s<a;){var c=o[s];u+=l.toIndexableString(c)+l.toIndexableString(e[c])}return u}return""}function s(e){var t=["boolean","number","string","object"].indexOf(typeof e);return~t?null===e?1:Array.isArray(e)?5:t<3?t+2:t+3:Array.isArray(e)?5:void 0}l.collate=function(e,t){if(e===t)return 0;e=l.normalizeKey(e),t=l.normalizeKey(t);var r,n,i=s(e),o=s(t);if(i-o!=0)return i-o;if(null===e)return 0;switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:e<t?-1:1;case"string":return(r=e)===(n=t)?0:n<r?1:-1}return(Array.isArray(e)?(e,t)=>{for(var r=Math.min(e.length,t.length),n=0;n<r;n++){var i=l.collate(e[n],t[n]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}:(e,t)=>{for(var r=Object.keys(e),n=Object.keys(t),i=Math.min(r.length,n.length),o=0;o<i;o++){var s=l.collate(r[o],n[o]);if(0!==s)return s;if(0!==(s=l.collate(e[r[o]],t[n[o]])))return s}return r.length===n.length?0:r.length>n.length?1:-1})(e,t)},l.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t,r=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var i=0;i<n;i++)e[i]=l.normalizeKey(r[i])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var o in e={},r)r.hasOwnProperty(o)&&void 0!==(t=r[o])&&(e[o]=l.normalizeKey(t))}}return e},l.toIndexableString=function(e){return s(e=l.normalizeKey(e))+f+r(e)+"\0"},l.parseIndexableString=function(e){for(var t,r,n,i,o=[],s=[],a=0;;){var u=e[a++];if("\0"===u){if(1===o.length)return o.pop();r=s,i=n=void 0,i=(t=o).pop(),r.length&&(i===(n=r[r.length-1]).element&&(r.pop(),n=r[r.length-1]),r=n.element,n=n.index,Array.isArray(r)?r.push(i):n===t.length-2?r[t.pop()]=i:t.push(i))}else switch(u){case"1":o.push(null);break;case"2":o.push("1"===e[a]),a++;break;case"3":var c=((e,t)=>{var r,n=t;if("1"===e[t])r=0,t++;else{var i="0"===e[t],o="",s=e.substring(++t,t+p),s=parseInt(s,10)+d;for(i&&(s=-s),t+=p;;){var a=e[t];if("\0"===a)break;o+=a,t++}r=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(r-=10),0!==s&&(r=parseFloat(r+"e"+s))}return{num:r,length:t-n}})(e,a);o.push(c.num),a+=c.length;break;case"4":for(var l="";;){var f=e[a];if("\0"===f)break;l+=f,a++}l=l.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),o.push(l);break;case"5":c={element:[],index:o.length};o.push(c.element),s.push(c);break;case"6":var h={element:{},index:o.length};o.push(h.element),s.push(h);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+u)}}}},{20:20}],20:[function(e,t,r){function n(e,t,r){for(var n="",i=r-e.length;n.length<i;)n+=t;return n}r.padLeft=function(e,t,r){return n(e,t,r)+e},r.padRight=function(e,t,r){return e+n(e,t,r)},r.stringLexCompare=function(e,t){for(var r=e.length,n=t.length,i=0;i<r;i++){if(i===n)return 1;var o=e.charAt(i),s=t.charAt(i);if(o!==s)return o<s?-1:1}return r<n?-1:0},r.intToDecimalForm=function(e){var t=e<0,r="";do{r=(t?-Math.ceil(e%10):Math.floor(e%10))+r}while(e=t?Math.ceil(e/10):Math.floor(e/10));return r=t&&"0"!==r?"-"+r:r}},{}],21:[function(e,t,r){function i(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}Object.defineProperty(r,"__esModule",{value:!0}),((e=e(22))&&"object"==typeof e&&"default"in e?e.default:e)(i,Error),i.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var e=new i({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),n=new i({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),o=new i({status:404,error:"not_found",reason:"missing"}),s=new i({status:409,error:"conflict",reason:"Document update conflict"}),a=new i({status:400,error:"invalid_id",reason:"_id field must contain a string"}),u=new i({status:412,error:"missing_id",reason:"_id is required for puts"}),c=new i({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),l=new i({status:412,error:"precondition_failed",reason:"Database not open"}),f=new i({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),h=new i({status:500,error:"badarg",reason:"Some query argument is invalid"}),d=new i({status:400,error:"invalid_request",reason:"Request was invalid"}),p=new i({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),y=new i({status:500,error:"doc_validation",reason:"Bad special document member"}),g=new i({status:400,error:"bad_request",reason:"Something wrong with the request"}),v=new i({status:400,error:"bad_request",reason:"Document must be a JSON object"}),m=new i({status:404,error:"not_found",reason:"Database not found"}),b=new i({status:500,error:"indexed_db_went_bad",reason:"unknown"}),w=new i({status:500,error:"web_sql_went_bad",reason:"unknown"}),_=new i({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),x=new i({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),k=new i({status:400,error:"bad_request",reason:"Invalid rev format"}),S=new i({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),E=new i({status:412,error:"missing_stub"}),O=new i({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),A=[e,n,o,s,a,u,c,l,f,h,d,p,y,g,v,m,w,_,x,k,S,E,b,O];function T(r,e,n){function t(e){for(var t in r)"function"!=typeof r[t]&&(this[t]=r[t]);void 0!==n&&(this.name=n),void 0!==e&&(this.reason=e)}return t.prototype=i.prototype,new t(e)}function L(t,r,n){var e=A.filter(function(e){return e[t]===r});return n&&e.filter(function(e){return e.message===n})[0]||e[0]}r.UNAUTHORIZED=e,r.MISSING_BULK_DOCS=n,r.MISSING_DOC=o,r.REV_CONFLICT=s,r.INVALID_ID=a,r.MISSING_ID=u,r.RESERVED_ID=c,r.NOT_OPEN=l,r.UNKNOWN_ERROR=f,r.BAD_ARG=h,r.INVALID_REQUEST=d,r.QUERY_PARSE_ERROR=p,r.DOC_VALIDATION=y,r.BAD_REQUEST=g,r.NOT_AN_OBJECT=v,r.DB_MISSING=m,r.WSQ_ERROR=w,r.LDB_ERROR=_,r.FORBIDDEN=x,r.INVALID_REV=k,r.FILE_EXISTS=S,r.MISSING_STUB=E,r.IDB_ERROR=b,r.INVALID_URL=O,r.getErrorTypeByProp=L,r.createError=T,r.generateErrorFromResponse=function(e){var t,r=!0===e.error&&"string"==typeof e.name?e.name:e.error,n=e.reason,i=L("name",r,n);return e.missing||"missing"===n||"deleted"===n||"not_found"===r?i=o:"doc_validation"===r?(i=y,t=n):"bad_request"===r&&i.message!==n&&(i=g),i=T(i=i||L("status",e.status,n)||f,n,r),t&&(i.message=t),e.id&&(i.id=e.id),e.status&&(i.status=e.status),e.missing&&(i.missing=e.missing),i}},{22:22}],22:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],23:[function(e,t,r){for(var n={},i=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],o=0;o<i.length;o++){var s=i[o];n["[object "+s+"]"]=s.toLowerCase()}var a=n.toString,u=n.hasOwnProperty;function c(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?n[a.call(e)]||"object":typeof e}function p(e){if(e&&"object"===c(e)&&!e.nodeType&&(null===(t=e)||t!==t.window)){var t,r;try{if(e.constructor&&!u.call(e,"constructor")&&!u.call(e.constructor.prototype,"isPrototypeOf"))return}catch(e){return}for(r in e);return void 0===r||u.call(e,r)}}function y(e){return"function"===c(e)}var g=Array.isArray||function(e){return"array"===c(e)};t.exports=function(){for(var e=[],t=-1,r=arguments.length,n=new Array(r);++t<r;)n[t]=arguments[t];var i,o={};for(e.push({args:n,result:{container:o,key:"key"}});i=e.pop();)!function(e,t,r){var n,i,o,s,a,u,c=t[0]||{},l=1,f=t.length,h=!1,d=/\d+/;"boolean"==typeof c&&(h=c,c=t[1]||{},l=2);"object"==typeof c||y(c)||(c={});f===l&&(c=this,--l);for(;l<f;l++)if(null!=(n=t[l]))for(i in u=g(n),n)i in Object.prototype||u&&!d.test(i)||(a=c[i],o=n[i],c!==o&&(h&&o&&(p(o)||(s=g(o)))?(a=s?(s=!1,a&&g(a)?a:[]):a&&p(a)?a:{},e.push({args:[h,a,o],result:{container:c,key:i}})):void 0===o||g(n)&&y(o)||(c[i]=o)));r.container[r.key]=c}(e,i.args,i.result);return o.key}},{}],24:[function(F,D,e){!function(N){!function(){function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var h=F(30),n=F(18),_=F(19),x=e(F(28)),d=F(27),s=e(F(33)),m=F(26),t=e(F(25));function i(){this.promise=new x(function(e){e()})}function b(e){var i,o=e.db,s=e.viewName,a=e.map,u=e.reduce,c=e.temporary,l=e.saveAs,f=a.toString()+(u&&u.toString())+"undefined"+(l||"");return!c&&(i=o._cachedViews=o._cachedViews||{})[f]?i[f]:(e=o.info().then(function(e){var r=e.db_name+"-";function t(){return h.upsert(o,"_local/mrviews",function(e){e.views=e.views||{};-1===(t=s).indexOf("/")&&(t=s+"/"+s);var t=e.views[t]=e.views[t]||{};if(!t[r])return t[r]=!0,e})}function n(){return o.registerDependentDatabase(r).then(function(e){var e=e.db,t=(e.auto_compaction=!0,{name:r,db:e,sourceDB:o,adapter:o.adapter,mapFun:a,reduceFun:u});return t.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return t.seq=e?e.seq:0,i&&t.db.once("destroyed",function(){delete i[f]}),t})})}return r+=l||"mrview-"+(c?"temp":d.stringMd5(f)),s?t().then(n):n()}),i&&(i[f]=e),e)}function k(e,t,r,n,i,o){return s("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:r,log:n,isArray:i,toJSON:o})}i.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},i.prototype.finish=function(){return this.promise};var r={},w=new i,S=50,E=h.guardedConsole.bind(null,"log");function O(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function A(t,r,n){try{return{output:r.apply(null,n)}}catch(e){r=t,n=e;try{r.emit("error",n)}catch(e){h.guardedConsole("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),h.guardedConsole("error",n)}return{error:e}}}function T(e,t){var r=_.collate(e.key,t.key);return 0!==r?r:_.collate(e.value,t.value)}function p(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function L(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&e.rows.forEach(function(e){var r=e.doc&&e.doc._attachments;r&&Object.keys(r).forEach(function(e){var t=r[e];r[e].data=n.base64StringToBlobOrBuffer(t.data,t.content_type)})}),e}}function u(e){return new v("builtin "+e+" function requires map values to be numbers or number arrays")}function I(e){for(var t=0,r=0,n=e.length;r<n;r++){var i=e[r];if("number"!=typeof i){if(!Array.isArray(i))throw u("_sum");for(var t="number"==typeof t?[t]:t,o=0,s=i.length;o<s;o++){var a=i[o];if("number"!=typeof a)throw u("_sum");void 0===t[o]?t.push(a):t[o]+=a}}else"number"==typeof t?t+=i:t[0]+=i}return t}var y={_sum:function(e,t){return I(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:I(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:(e=>{for(var t=0,r=0,n=e.length;r<n;r++){var i=e[r];t+=i*i}return t})(t)}}};function j(e,t,r,n){t=t[e];void 0!==t&&(n&&(t=encodeURIComponent(JSON.stringify(t))),r.push(e+"="+t))}function o(e){var t;if(void 0!==e)return t=Number(e),isNaN(t)||t!==parseInt(e,10)?e:t}function Q(t,e){var r=t.descending?"endkey":"startkey",n=t.descending?"startkey":"endkey";if(void 0!==t[r]&&void 0!==t[n]&&0<_.collate(t[r],t[n]))throw new f("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new f("{include_docs:true} is invalid for reduce");if(t.keys&&1<t.keys.length&&!t.group&&!t.group_level)throw new f("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(e){e=(e=>{if(e)return"number"!=typeof e?new f('Invalid value for integer: "'+e+'"'):e<0?new f('Invalid value for positive integer: "'+e+'"'):void 0})(t[e]);if(e)throw e})}function a(t){return function(e){if(404===e.status)return t;throw e}}function c(e,t,r){var n="_local/doc_"+e,i={_id:n,keys:[]},r=r[e],l=r.indexableKeysToKeyValues;return(1===(e=r.changes).length&&/^1-/.test(e[0].rev)?x.resolve(i):t.db.get(n).catch(a(i))).then(function(c){return((e=c).keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):x.resolve({rows:[]})).then(function(e){for(var t=c,r=e,n=[],i={},o=0,s=r.rows.length;o<s;o++){var a,u=r.rows[o].doc;u&&(n.push(u),i[u._id]=!0,u._deleted=!l[u._id],u._deleted||"value"in(a=l[u._id])&&(u.value=a.value))}e=Object.keys(l);return e.forEach(function(e){var t;i[e]||(t={_id:e},"value"in(e=l[e])&&(t.value=e.value),n.push(t))}),t.keys=m.uniq(e.concat(t.keys)),n.push(t),n});var e})}function g(e){e="string"==typeof e?e:e.name;return r[e]||(r[e]=new i)}function P(e){return m.sequentialize(g(e),function(){var p,y,g,t,v=e;function r(e,t){e={id:y._id,key:_.normalizeKey(e)};null!=t&&(e.value=_.normalizeKey(t)),p.push(e)}g="function"==typeof v.mapFun&&2===v.mapFun.length?(t=v.mapFun,function(e){return t(e,r)}):k(v.mapFun.toString(),r,I,E,Array.isArray,JSON.parse);var m=v.seq||0;function b(t,o){return function(){return n=t,i=o,e="_local/lastSeq",(r=v).db.get(e).catch(a({_id:e,seq:0})).then(function(t){var e=Object.keys(n);return x.all(e.map(function(e){return c(e,r,n)})).then(function(e){e=h.flatten(e);return t.seq=i,e.push(t),r.db.bulkDocs({docs:e})})});var r,n,i,e}}var w=new i;return new x(function(e,t){function d(){w.finish().then(function(){v.seq=m,e()})}!function h(){v.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:m,limit:S}).on("complete",function(e){var t=e.results;if(!t.length)return d();for(var r={},n=0,i=t.length;n<i;n++){var o=t[n];if("_"!==o.doc._id[0]){p=[],(y=o.doc)._deleted||A(v.sourceDB,g,[y]),p.sort(T);for(var s,a={},u=0,c=p.length;u<c;u++){var l=p[u],f=[l.key,l.id];0===_.collate(l.key,s)&&f.push(u),s=(a[_.toIndexableString(f)]=l).key}r[o.doc._id]={indexableKeysToKeyValues:a,changes:o.changes}}m=o.seq}return w.add(b(r,m)),(t.length<S?d:h)()}).on("error",function(e){t(e)})}()})})()}function R(l,f){return m.sequentialize(g(l),function(){var r,e,t,n,i=l,o=f,s=i.reduceFun&&!1!==o.reduce,a=o.skip||0;function u(e){return e.include_docs=!0,i.db.allDocs(e).then(function(e){return r=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),r=["id","key","value"];if(!(t<r||r<t))return e.doc.value}r=_.parseIndexableString(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function c(t){var e,n=s?((e,t,r)=>{0===r.group_level&&delete r.group_level;var n=r.group||r.group_level,i=y[e.reduceFun]||k(e.reduceFun.toString(),null,I,E,Array.isArray,JSON.parse),o=[],s=isNaN(r.group_level)?Number.POSITIVE_INFINITY:r.group_level;t.forEach(function(e){var t=o[o.length-1],r=n?e.key:null;n&&Array.isArray(r)&&(r=r.slice(0,s)),t&&0===_.collate(t.groupKey,r)?(t.keys.push([e.key,e.id]),t.values.push(e.value)):o.push({keys:[[e.key,e.id]],values:[e.value],groupKey:r})}),t=[];for(var a,u,c=0,l=o.length;c<l;c++){var f=o[c],h=A(e.sourceDB,i,[f.keys,f.values,!1]);if(h.error&&h.error instanceof v)throw h.error;t.push({value:h.error?null:h.output,key:f.groupKey})}return{rows:(a=t,u=r.limit,r=(r=r.skip)||0,"number"==typeof u?a.slice(r,u+r):0<r?a.slice(r):a)}})(i,t,o):{total_rows:r,offset:a,rows:t};return o.include_docs?(e=m.uniq(t.map(p)),i.sourceDB.allDocs({keys:e,include_docs:!0,conflicts:o.conflicts,attachments:o.attachments,binary:o.binary}).then(function(e){var r={};return e.rows.forEach(function(e){e.doc&&(r["$"+e.id]=e.doc)}),t.forEach(function(e){var t=p(e),t=r["$"+t];t&&(e.doc=t)}),n})):n}return void 0===o.keys||o.keys.length||(o.limit=0,delete o.keys),(void 0!==o.keys?o._raw_keys?u({keys:o.keys}):(e=o.keys.map(function(e){return u({startkey:_.toIndexableString([e]),endkey:_.toIndexableString([e,{}])})}),x.all(e).then(h.flatten)):(e={descending:o.descending},o.start_key&&(o.startkey=o.start_key),o.end_key&&(o.endkey=o.end_key),void 0!==o.startkey&&(e.startkey=o.descending?_.toIndexableString([o.startkey,{}]):_.toIndexableString([o.startkey])),void 0!==o.endkey&&(t=!1!==o.inclusive_end,o.descending&&(t=!t),e.endkey=_.toIndexableString(t?[o.endkey,{}]:[o.endkey])),void 0!==o.key&&(t=_.toIndexableString([o.key]),n=_.toIndexableString([o.key,{}]),e.descending?(e.endkey=t,e.startkey=n):(e.startkey=t,e.endkey=n)),s||("number"==typeof o.limit&&(e.limit=o.limit),e.skip=a),u(e))).then(c)})()}var l=m.callbackify(function(){var e,t,r=this;return"http"===r.type()?r.request({method:"POST",url:"_view_cleanup"}):"function"==typeof r._viewCleanup?(e=r,new x(function(r,n){e._viewCleanup(function(e,t){if(e)return n(e);r(t)})})):(t=r).get("_local/mrviews").then(function(s){var r={},e=(Object.keys(s.views).forEach(function(e){var e=O(e),t="_design/"+e[0],e=e[1];r[t]=r[t]||{},r[t][e]=!0}),{keys:Object.keys(r),include_docs:!0});return t.allDocs(e).then(function(e){var o={};e.rows.forEach(function(n){var i=n.key.substring(8);Object.keys(r[n.key]).forEach(function(e){var t=i+"/"+e,t=(s.views[t]||(t=e),Object.keys(s.views[t])),r=n.doc&&n.doc.views&&n.doc.views[e];t.forEach(function(e){o[e]=o[e]||r})})});e=Object.keys(o).filter(function(e){return!o[e]}).map(function(e){return m.sequentialize(g(e),function(){return new t.constructor(e,t.__opts).destroy()})()});return x.all(e).then(function(){return{ok:!0}})})},a({ok:!0}))});function C(t,e,r){var n,i,o,s,a,u,c,l,f,h,d,p,y,g;return"http"===t.type()?(n=t,i=e,f="GET",j("reduce",o=r,a=[]),j("include_docs",o,a),j("attachments",o,a),j("limit",o,a),j("descending",o,a),j("group",o,a),j("group_level",o,a),j("skip",o,a),j("stale",o,a),j("conflicts",o,a),j("startkey",o,a,!0),j("start_key",o,a,!0),j("endkey",o,a,!0),j("end_key",o,a,!0),j("inclusive_end",o,a),j("key",o,a,!0),a=""===(a=a.join("&"))?"":"?"+a,void 0!==o.keys&&((p="keys="+encodeURIComponent(JSON.stringify(o.keys))).length+a.length+1<=2e3?a+=("?"===a[0]?"&":"?")+p:(f="POST","string"==typeof i?s={keys:o.keys}:i.keys=o.keys)),("string"==typeof i?(p=O(i),n.request({method:f,url:"_design/"+p[0]+"/_view/"+p[1]+a,body:s})):(s=s||{},Object.keys(i).forEach(function(e){Array.isArray(i[e])?s[e]=i[e]:s[e]=i[e].toString()}),n.request({method:"POST",url:"_temp_view"+a,body:s}))).then(L(o))):"function"==typeof t._query?(u=t,c=e,l=r,new x(function(r,n){u._query(c,l,function(e,t){if(e)return n(e);r(t)})})):r.saveAs?(f={db:t,saveAs:r.saveAs,map:e.map,reduce:e.reduce},r.destroy?b(f).then(function(e){return e.db.destroy()}):(Q(r,e),b(f).then(v))):"string"!=typeof e?(Q(r,e),h={db:t,viewName:"temp_view/temp_view",map:e.map,reduce:e.reduce,temporary:!0},w.add(function(){return b(h).then(function(e){return m.fin(P(e).then(function(){return R(e,r)}),function(){return e.db.destroy()})})}),w.finish()):(p=O(d=e),y=p[0],g=p[1],t.get("_design/"+y).then(function(e){e=e.views&&e.views[g];if(e&&"string"==typeof e.map)return Q(r,e),b({db:t,viewName:d,map:e.map,reduce:e.reduce}).then(v);throw new B("ddoc "+y+" has no view named "+g)}));function v(e){return"ok"===r.stale||"update_after"===r.stale?("update_after"===r.stale&&N.nextTick(function(){P(e)}),R(e,r)):P(e).then(function(){return R(e,r)})}}function f(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,f)}catch(e){}}function B(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,B)}catch(e){}}function v(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,v)}catch(e){}}t(f,Error),t(B,Error),t(v,Error),D.exports={_search_query:function(e,t,r){"function"==typeof t&&(r=t,t={}),t=t?((i=t).group_level=o(i.group_level),i.limit=o(i.limit),i.skip=o(i.skip),i):{},(e="function"==typeof e?{map:e}:e).saveAs&&(t.saveAs=e.saveAs,delete e.saveAs);var n=this,i=x.resolve().then(function(){return C(n,e,t)});return m.promisedCallback(i,r),i},_search_viewCleanup:l}}.call(this)}.call(this,F(32))},{18:18,19:19,25:25,26:26,27:27,28:28,30:30,32:32,33:33}],25:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{22:22}],26:[function(i,e,o){!function(r){!function(){Object.defineProperty(o,"__esModule",{value:!0});function n(e,t){return t&&e.then(function(e){r.nextTick(function(){t(null,e)})},function(e){r.nextTick(function(){t(e)})}),e}var e,t=(e=i(2))&&"object"==typeof e&&"default"in e?e.default:e;o.uniq=function(e){for(var t={},r=0,n=e.length;r<n;r++)t["$"+e[r]]=!0;for(var i=Object.keys(t),o=new Array(i.length),r=0,n=i.length;r<n;r++)o[r]=i[r].substring(1);return o},o.sequentialize=function(r,n){return function(){var e=arguments,t=this;return r.add(function(){return n.apply(t,e)})}},o.fin=function(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})},o.callbackify=function(r){return t(function(e){var t=e.pop(),e=r.apply(this,e);return"function"==typeof t&&n(e,t),e})},o.promisedCallback=n}.call(this)}.call(this,i(32))},{2:2,32:32}],27:[function(n,e,i){!function(t){!function(){Object.defineProperty(i,"__esModule",{value:!0});var e,l=n(18),r=(e=n(34))&&"object"==typeof e&&"default"in e?e.default:e,f=t.setImmediate||t.setTimeout;function h(e,t,r,n){(0<r||n<t.byteLength)&&(t=new Uint8Array(t,r,Math.min(n,t.byteLength)-r)),e.append(t)}function d(e,t,r,n){(0<r||n<t.length)&&(t=t.substring(r,n)),e.appendBinary(t)}i.binaryMd5=function(n,i){var e="string"==typeof n,t=e?n.length:n.byteLength,o=Math.min(32768,t),s=Math.ceil(t/o),a=0,u=new(e?r:r.ArrayBuffer),c=e?d:h;!function e(){var t=a*o,r=t+o;++a<s?(c(u,n,t,r),f(e)):(c(u,n,t,r),t=u.end(!0),r=l.btoa(t),i(r),u.destroy())}()},i.stringMd5=function(e){return r.hash(e)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{18:18,34:34}],28:[function(e,t,r){e=(e=e(29))&&"object"==typeof e&&"default"in e?e.default:e,e="function"==typeof Promise?Promise:e;t.exports=e},{29:29}],29:[function(e,t,r){var i=e(8);function u(){}var c={},o=["REJECTED"],s=["FULFILLED"],n=["PENDING"];function a(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=n,this.queue=[],this.outcome=void 0,e!==u&&d(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(t,r,n){i(function(){var e;try{e=r(n)}catch(e){return c.reject(t,e)}e===t?c.reject(t,new TypeError("Cannot resolve promise with itself")):c.resolve(t,e)})}function h(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,c.reject(t,e))}function i(e){r||(r=!0,c.resolve(t,e))}var o=p(function(){e(i,n)});"error"===o.status&&n(o.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=a).prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){var r;return"function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o?this:(r=new this.constructor(u),this.state!==n?f(r,this.state===s?e:t,this.outcome):this.queue.push(new l(r,e,t)),r)},l.prototype.callFulfilled=function(e){c.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){c.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},c.resolve=function(e,t){var r=p(h,t);if("error"===r.status)return c.reject(e,r.value);r=r.value;if(r)d(e,r);else{e.state=s,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callFulfilled(t)}return e},c.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},a.resolve=function(e){if(e instanceof this)return e;return c.resolve(new this(u),e)},a.reject=function(e){var t=new this(u);return c.reject(t,e)},a.all=function(e){var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);var o=new Array(n),s=0,t=-1,a=new this(u);for(;++t<n;)((e,t)=>{r.resolve(e).then(function(e){o[t]=e,++s!==n||i||(i=!0,c.resolve(a,o))},function(e){i||(i=!0,c.reject(a,e))})})(e[t],t);return a},a.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);var i=-1,o=new this(u);for(;++i<r;)(e=>{t.resolve(e).then(function(e){n||(n=!0,c.resolve(o,e))},function(e){n||(n=!0,c.reject(o,e))})})(e[i]);return o}},{8:8}],30:[function(Q,e,P){!function(j){!function(){function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(P,"__esModule",{value:!0});var l=e(Q(28)),n=e(Q(2)),t=e(Q(5)),r=Q(7),i=e(Q(31)),s=Q(21);function a(e){var t,r,n;return e instanceof ArrayBuffer?"function"==typeof(n=e).slice?n.slice(0):(t=new ArrayBuffer(n.byteLength),r=new Uint8Array(t),n=new Uint8Array(n),r.set(n),t):(r=e.size,n=e.type,"function"==typeof e.slice?e.slice(0,r,n):e.webkitSlice(0,r,n))}var u=Function.prototype.toString,c=u.call(Object);function f(e){var t,r,n,i,o;if(!e||"object"!=typeof e)return e;if(Array.isArray(e))for(t=[],r=0,n=e.length;r<n;r++)t[r]=f(e[r]);else{if(e instanceof Date)return e.toISOString();if((i=e)instanceof ArrayBuffer||"undefined"!=typeof Blob&&i instanceof Blob)return a(e);if(i=e,!(null===(i=Object.getPrototypeOf(i))||"function"==typeof(i=i.constructor)&&i instanceof i&&u.call(i)==c))return e;for(r in t={},e)Object.prototype.hasOwnProperty.call(e,r)&&void 0!==(o=f(e[r]))&&(t[r]=o)}return t}function h(t){var r=!1;return n(function(e){if(r)throw new Error("once called more than once");r=!0,t.apply(this,e)})}function o(s){return n(function(i){i=f(i);var t,o=this,r="function"==typeof i[i.length-1]&&i.pop(),e=(r&&(t=function(e,t){j.nextTick(function(){r(e,t)})}),new l(function(r,n){var e;try{var t=h(function(e,t){e?n(e):r(t)});i.push(t),(e=s.apply(o,i))&&"function"==typeof e.then&&r(e)}catch(e){n(e)}}));return t&&e.then(function(e){t(null,e)},t),e})}var d=t("pouchdb:api");function p(e,t){for(var r={},n=0,i=t.length;n<i;n++){var o=t[n];o in e&&(r[o]=e[o])}return r}var y;function g(e){return e}function v(e){return[{ok:e}]}function m(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}if(m())y=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),y=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){y=!1}function b(){return y}function w(){var t;r.EventEmitter.call(this),this._listeners={},t=this,m()?chrome.storage.onChanged.addListener(function(e){null!=e.db_name&&t.emit(e.dbName.newValue)}):y&&("undefined"!=typeof addEventListener?addEventListener("storage",function(e){t.emit(e.key)}):window.attachEvent("storage",function(e){t.emit(e.key)}))}function _(e){var t;"undefined"!==console&&e in console&&(t=Array.prototype.slice.call(arguments,1),console[e].apply(console,t))}function x(e,t){for(var r in t){var n;t.hasOwnProperty(r)&&void 0!==(n=f(t[r]))&&(e[r]=n)}}i(w,r.EventEmitter),w.prototype.addListener=function(e,t,r,n){var i,o;function s(){var e;i._listeners[t]&&(o?o="waiting":(o=!0,e=p(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]),r.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===o&&setTimeout(function(){s()},0),o=!1}).on("error",function(){o=!1})))}this._listeners[t]||(o=!1,(i=this)._listeners[t]=s,this.on(e,s))},w.prototype.removeListener=function(e,t){t in this._listeners&&r.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},w.prototype.notifyLocalWindows=function(e){m()?chrome.storage.local.set({dbName:e}):y&&(localStorage[e]="a"===localStorage[e]?"b":"a")},w.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};t=function(){}.name?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]},i=t;function k(e){var t;return e?2===(t=e.split("/")).length?t:1===t.length?[e,e]:null:null}var S=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],E="queryKey",O=/(?:^|&)([^&=]*)=?([^&]*)/g,A=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function T(a,u,c){return new l(function(o,s){a.get(u,function(e,t){if(e){if(404!==e.status)return s(e);t={}}var r,n,i,e=t._rev,t=c(t);if(!t)return o({updated:!1,rev:e});t._id=u,t._rev=e,o((n=t,i=c,(r=a).put(n).then(function(e){return{updated:!0,rev:e.rev}},function(e){if(409!==e.status)throw e;return T(r,n._id,i)})))})})}var L="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");function I(e){return 0|Math.random()*e}P.adapterFun=function(u,c){return o(n(function(n){if(this._closed)return l.reject(new Error("database is closed"));if(this._destroyed)return l.reject(new Error("database is destroyed"));var i=this,o=i,s=u,e=n;if(d.enabled){for(var t=[o._db_name,s],r=0;r<e.length-1;r++)t.push(e[r]);d.apply(null,t);var a=e[e.length-1];e[e.length-1]=function(e,t){var r=(r=[o._db_name,s]).concat(e?["error",e]:["success",t]);d.apply(null,r),a(e,t)}}return this.taskqueue.isReady?c.apply(this,n):new l(function(t,r){i.taskqueue.addTask(function(e){e?r(e):t(i[u].apply(i,n))})})}))},P.bulkGetShim=function(s,a,e){var t=a.docs,u={},n=(t.forEach(function(e){e.id in u?u[e.id].push(e):u[e.id]=[e]}),Object.keys(u).length),i=0,c=new Array(n);function l(){var r;++i===n&&(r=[],c.forEach(function(t){t.docs.forEach(function(e){r.push({id:t.id,docs:[e]})})}),e(null,{results:r}))}var r=Object.keys(u),f=0;function h(){var e,o;f>=r.length||(e=Math.min(f+6,r.length),e=r.slice(f,e),o=f,e.forEach(function(r,e){var n=o+e,e=u[r],t=p(e[0],["atts_since","attachments"]),i=(t.open_revs=e.map(function(e){return e.rev}),t.open_revs=t.open_revs.filter(g),g);0===t.open_revs.length&&(delete t.open_revs,i=v),["revs","attachments","binary","ajax"].forEach(function(e){e in a&&(t[e]=a[e])}),s.get(r,t,function(e,t){e=e?[{error:e}]:i(t);t=e,c[n]={id:r,docs:t},l(),h()})}),f+=e.length)}h()},P.changesHandler=w,P.clone=f,P.defaultBackOff=function(e){var t,r;return t=(e=e)?0:2e3,e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,6e5<t&&(e=3e5,t=6e5),r=Math.random(),~~((t-e)*r+e)},P.explainError=function(e,t){_("info","The above "+e+" is totally normal. "+t)},P.extend=function(e,t,r){return x(e,t),r&&x(e,r),e},P.filterChange=function(n){var i={},o=n.filter&&"function"==typeof n.filter;return i.query=n.query_params,function(e){e.doc||(e.doc={});var t=o&&((t,e,r)=>{try{return!t(e,r)}catch(e){t="Filter function threw: "+e.toString();return s.createError(s.BAD_REQUEST,t)}})(n.filter,e.doc,i);if("object"==typeof t)return t;if(t)return!1;if(n.include_docs){if(!n.attachments)for(var r in e.doc._attachments)e.doc._attachments.hasOwnProperty(r)&&(e.doc._attachments[r].stub=!0)}else delete e.doc;return!0}},P.flatten=function(e){for(var t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r]);return t},P.functionName=i,P.guardedConsole=_,P.hasLocalStorage=b,P.invalidIdError=function(e){var t;if(e?"string"!=typeof e?t=s.createError(s.INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=s.createError(s.RESERVED_ID)):t=s.createError(s.MISSING_ID),t)throw t},P.isChromeApp=m,P.isCordova=function(){return"undefined"!=typeof cordova||"undefined"!=typeof PhoneGap||"undefined"!=typeof phonegap},P.listenerCount=function(e,t){return"listenerCount"in e?e.listenerCount(t):r.EventEmitter.listenerCount(e,t)},P.normalizeDdocFunctionName=function(e){return(e=k(e))?e.join("/"):null},P.once=h,P.parseDdocFunctionName=k,P.parseUri=function(e){for(var t=A.exec(e),n={},r=14;r--;){var i=S[r],o=t[r]||"",s=-1!==["user","password"].indexOf(i);n[i]=s?decodeURIComponent(o):o}return n[E]={},n[S[12]].replace(O,function(e,t,r){t&&(n[E][t]=r)}),n},P.pick=p,P.toPromise=o,P.upsert=T,P.uuid=function(e,t){t=t||L.length;var r="",n=-1;if(e)for(;++n<e;)r+=L[I(t)];else for(;++n<36;)switch(n){case 8:case 13:case 18:case 23:r+="-";break;case 19:r+=L[3&I(16)|8];break;default:r+=L[I(16)]}return r}}.call(this)}.call(this,Q(32))},{2:2,21:21,28:28,31:31,32:32,5:5,7:7}],31:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{22:22}],32:[function(e,t,r){var n,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return(n=setTimeout)(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length)&&d()}function d(){if(!l){for(var e=a(h),t=(l=!0,c.length);t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,!function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function y(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||l||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=y,t.addListener=y,t.once=y,t.off=y,t.removeListener=y,t.removeAllListeners=y,t.emit=y,t.prependListener=y,t.prependOnceListener=y,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],33:[function(e,t,r){!function(){var s={}.hasOwnProperty,a=[].slice;t.exports=function(e,t){var r,n,i=[],o=[];for(r in t)s.call(t,r)&&(n=t[r],"this"!==r)&&(i.push(r),o.push(n));return Function.apply(null,a.call(i).concat([e])).apply(t.this,o)}}.call(this)},{}],34:[function(e,t,r){function n(i){var s=function(e,t){return e+t&4294967295},n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(e,t,r,n,i,o){return t=s(s(t,e),s(n,o)),s(t<<i|t>>>32-i,r)}function u(e,t,r,n,i,o,s){return a(t&r|~t&n,e,t,i,o,s)}function c(e,t,r,n,i,o,s){return a(t&n|r&~n,e,t,i,o,s)}function l(e,t,r,n,i,o,s){return a(t^r^n,e,t,i,o,s)}function f(e,t,r,n,i,o,s){return a(r^(t|~n),e,t,i,o,s)}function h(e,t){var r=u(e[0],o=e[1],i=e[2],n=e[3],t[0],7,-680876936),n=u(n,r,o,i,t[1],12,-389564586),i=u(i,n,r,o,t[2],17,606105819),o=u(o,i,n,r,t[3],22,-1044525330);r=u(r,o,i,n,t[4],7,-176418897),n=u(n,r,o,i,t[5],12,1200080426),i=u(i,n,r,o,t[6],17,-1473231341),o=u(o,i,n,r,t[7],22,-45705983),r=u(r,o,i,n,t[8],7,1770035416),n=u(n,r,o,i,t[9],12,-1958414417),i=u(i,n,r,o,t[10],17,-42063),o=u(o,i,n,r,t[11],22,-1990404162),r=u(r,o,i,n,t[12],7,1804603682),n=u(n,r,o,i,t[13],12,-40341101),i=u(i,n,r,o,t[14],17,-1502002290),r=c(r,o=u(o,i,n,r,t[15],22,1236535329),i,n,t[1],5,-165796510),n=c(n,r,o,i,t[6],9,-1069501632),i=c(i,n,r,o,t[11],14,643717713),o=c(o,i,n,r,t[0],20,-373897302),r=c(r,o,i,n,t[5],5,-701558691),n=c(n,r,o,i,t[10],9,38016083),i=c(i,n,r,o,t[15],14,-660478335),o=c(o,i,n,r,t[4],20,-405537848),r=c(r,o,i,n,t[9],5,568446438),n=c(n,r,o,i,t[14],9,-1019803690),i=c(i,n,r,o,t[3],14,-187363961),o=c(o,i,n,r,t[8],20,1163531501),r=c(r,o,i,n,t[13],5,-1444681467),n=c(n,r,o,i,t[2],9,-51403784),i=c(i,n,r,o,t[7],14,1735328473),r=l(r,o=c(o,i,n,r,t[12],20,-1926607734),i,n,t[5],4,-378558),n=l(n,r,o,i,t[8],11,-2022574463),i=l(i,n,r,o,t[11],16,1839030562),o=l(o,i,n,r,t[14],23,-35309556),r=l(r,o,i,n,t[1],4,-1530992060),n=l(n,r,o,i,t[4],11,1272893353),i=l(i,n,r,o,t[7],16,-155497632),o=l(o,i,n,r,t[10],23,-1094730640),r=l(r,o,i,n,t[13],4,681279174),n=l(n,r,o,i,t[0],11,-358537222),i=l(i,n,r,o,t[3],16,-722521979),o=l(o,i,n,r,t[6],23,76029189),r=l(r,o,i,n,t[9],4,-640364487),n=l(n,r,o,i,t[12],11,-421815835),i=l(i,n,r,o,t[15],16,530742520),r=f(r,o=l(o,i,n,r,t[2],23,-995338651),i,n,t[0],6,-198630844),n=f(n,r,o,i,t[7],10,1126891415),i=f(i,n,r,o,t[14],15,-1416354905),o=f(o,i,n,r,t[5],21,-57434055),r=f(r,o,i,n,t[12],6,1700485571),n=f(n,r,o,i,t[3],10,-1894986606),i=f(i,n,r,o,t[10],15,-1051523),o=f(o,i,n,r,t[1],21,-2054922799),r=f(r,o,i,n,t[8],6,1873313359),n=f(n,r,o,i,t[15],10,-30611744),i=f(i,n,r,o,t[6],15,-1560198380),o=f(o,i,n,r,t[13],21,1309151649),r=f(r,o,i,n,t[4],6,-145523070),n=f(n,r,o,i,t[11],10,-1120210379),i=f(i,n,r,o,t[2],15,718787259),o=f(o,i,n,r,t[9],21,-343485551),e[0]=s(r,e[0]),e[1]=s(o,e[1]),e[2]=s(i,e[2]),e[3]=s(n,e[3])}function d(e){for(var t=[],r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}function p(e){for(var t=[],r=0;r<64;r+=4)t[r>>2]=e[r]+(e[r+1]<<8)+(e[r+2]<<16)+(e[r+3]<<24);return t}function r(e){for(var t,r,n,i,o=e.length,s=[1732584193,-271733879,-1732584194,271733878],a=64;a<=o;a+=64)h(s,d(e.substring(a-64,a)));for(t=(e=e.substring(a-64)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=0;a<t;a+=1)r[a>>2]|=e.charCodeAt(a)<<(a%4<<3);if(r[a>>2]|=128<<(a%4<<3),55<a)for(h(s,r),a=0;a<16;a+=1)r[a]=0;return i=(i=8*o).toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(i[2],16),i=parseInt(i[1],16)||0,r[14]=n,r[15]=i,h(s,r),s}function y(e){for(var t=0;t<e.length;t+=1)e[t]=(e=>{for(var t="",r=0;r<4;r+=1)t+=n[e>>8*r+4&15]+n[e>>8*r&15];return t})(e[t]);return e.join("")}function o(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}function g(e){return e=/[\u0080-\uFFFF]/.test(e)?unescape(encodeURIComponent(e)):e}function v(e){for(var t=[],r=e.length,n=0;n<r-1;n+=2)t.push(parseInt(e.substr(n,2),16));return String.fromCharCode.apply(String,t)}function m(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==y(r("hello"))&&(s=function(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var r=this.byteLength,e=o(e,r),n=r;return(n=t!==i?o(t,r):n)<e?new ArrayBuffer(0):(t=n-e,r=new ArrayBuffer(t),n=new Uint8Array(r),e=new Uint8Array(this,e,t),n.set(e),r)}),m.prototype.append=function(e){return this.appendBinary(g(e)),this},m.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;for(var t=this._buff.length,r=64;r<=t;r+=64)h(this._hash,d(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},m.prototype.end=function(e){for(var t,r=this._buff,n=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;o<n;o+=1)i[o>>2]|=r.charCodeAt(o)<<(o%4<<3);return this._finish(i,n),t=y(this._hash),e&&(t=v(t)),this.reset(),t},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},m.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(e,t){var r,n=t;if(e[n>>2]|=128<<(n%4<<3),55<n)for(h(this._hash,e),n=0;n<16;n+=1)e[n]=0;t=(t=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(t[2],16),t=parseInt(t[1],16)||0,e[14]=r,e[15]=t,h(this._hash,e)},m.hash=function(e,t){return m.hashBinary(g(e),t)},m.hashBinary=function(e,t){e=y(r(e));return t?v(e):e},(m.ArrayBuffer=function(){this.reset()}).prototype.append=function(e){r=this._buff.buffer,n=e,i=!0,(o=new Uint8Array(r.byteLength+n.byteLength)).set(new Uint8Array(r)),o.set(new Uint8Array(n),r.byteLength);var t,r,n,i,o,s=i?o:o.buffer,a=s.length;for(this._length+=e.byteLength,t=64;t<=a;t+=64)h(this._hash,p(s.subarray(t-64,t)));return this._buff=t-64<a?new Uint8Array(s.buffer.slice(t-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(e){for(var t,r=this._buff,n=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;o<n;o+=1)i[o>>2]|=r[o]<<(o%4<<3);return this._finish(i,n),t=y(this._hash),e&&(t=v(t)),this.reset(),t},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var e,t=m.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},m.ArrayBuffer.prototype.setState=function(e){return e.buff=((e,t)=>{for(var r=e.length,n=new ArrayBuffer(r),i=new Uint8Array(n),o=0;o<r;o+=1)i[o]=e.charCodeAt(o);return t?i:n})(e.buff,!0),m.prototype.setState.call(this,e)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(e,t){e=y((e=>{for(var t,r,n,i,o=e.length,s=[1732584193,-271733879,-1732584194,271733878],a=64;a<=o;a+=64)h(s,p(e.subarray(a-64,a)));for(t=(e=a-64<o?e.subarray(a-64):new Uint8Array(0)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=0;a<t;a+=1)r[a>>2]|=e[a]<<(a%4<<3);if(r[a>>2]|=128<<(a%4<<3),55<a)for(h(s,r),a=0;a<16;a+=1)r[a]=0;return i=(i=8*o).toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(i[2],16),i=parseInt(i[1],16)||0,r[14]=n,r[15]=i,h(s,r),s})(new Uint8Array(e)));return t?v(e):e},m}var i;if("object"==typeof r)t.exports=n();else{try{i=window}catch(e){i=self}i.SparkMD5=n()}},{}],35:[function(e,t,r){var n=e(24),I=(Object.keys(n).forEach(function(e){r[e]=n[e]}),e(19).toIndexableString),j=e(1),Q=e(15),i=j.Promise,P=e(11),R={};function B(e,t){return e+t}function C(e,t,n=!1){for(var i,o=[],s=[],r=0,a=t._stack.length;r<a;r++)0<=t._stack[r].label.indexOf("trimmer")?i=t._stack[r]:0<=t._stack[r].label.indexOf("stemmer")?o.push(t._stack[r]):0<=t._stack[r].label.indexOf("stopWordFilter")&&s.push(t._stack[r]);var u=Q.tokenizer(e).map(function(e){if(!(n&&0<=e.toString().indexOf("*"))){i(e);for(var t=0,r=s.length;t<r;t++)s[t](e)}return e.toString()}),c=u.map(function(e){for(var t=new Q.Token(e),r=0,n=o.length;r<n;r++)o[r](t);return t.toString()});if(!n)for(r=0,a=u.length;r<a;r++)-1===c.indexOf(u[r])&&c.push(u[r]);return c}function p(e,t){if(e.getText)return e.getText(t);if(e.deepField)for(var r=t,n=0,i=e.deepField.length;n<i;n++)r=Array.isArray(r)?r.map(((t,r)=>function(e){return p(j.extend({},t,{deepField:r}),e)})(e,e.deepField.slice(n))):r&&r[e.deepField[n]];else r=t[e.field];return r&&(Array.isArray(r)?r=r.join(" "):"string"!=typeof r&&(r=r.toString())),r}function N(l,f,h,d){return function(e,t){if(!((e,t,r)=>{try{return t&&!t(e)}catch(e){return r.emit("error",e),1}})(e,h,d)){for(var r=[],n=0,i=l.length;n<i;n++){var o,s=l[n],s=s.getText?s.getText(e):p(s,e);if(s){for(var a=C(s,f.pipeline),u=0,c=a.length;u<c;u++)t("a"+a[u],1<l.length?n:void 0);o=Math.sqrt(a.length)}else o=0;r.push(o)}t("b"+e._id,r)}}}function F(t,r){return i.all(r.map(function(e){return t.get(e.id)})).then(function(e){e.forEach(function(e,t){r[t].doc=e})}).then(function(){return r})}function D(e,t,r,s,n){var a=t.highlighting_pre||"<strong>",u=t.highlighting_post||"</strong>";return i.all(r.map(function(o){return i.resolve().then(function(){return o.doc||e.get(o.id)}).then(function(i){o.highlighting={},n[o.id].forEach(function(e,t){var t=s[t],r=t.field,n=p(t,i);Object.keys(e).forEach(function(e){e=new RegExp("("+e+"[a-z]*)","gi");n=n.replace(e,a+"$1"+u),o.highlighting[r]=n})})})})).then(function(){return r})}r.search=j.toPromise(function(u,c){var t,e,f=this,r=(u=j.extend(!0,{},u)).query||u.q,h="mm"in u?parseFloat(u.mm)/100:1,n=u.fields,d=u.highlighting,p=u.include_docs,i=u.destroy,y=u.stale,g=u.limit,o=u.build,s=o?u.lunrOptions:null,v=u.skip||0,a=u.language||"en",l=u.filter,m=u.getText||{},b=(Array.isArray(n)&&(t={},n.forEach(function(e){t[e]=1}),n=t),Object.keys(n).map(function(e){var t=-1!==e.indexOf(".")&&e.split(".");return{field:e,getText:m[e],deepField:t,boost:n[e]}})),w=R[a],_=(w||((w=R[a]=Q(function(){s&&s.bind(this)(Q),e=this.pipeline,Array.isArray(a)?this.use(Q.multiLanguage.apply(this,a)):"en"!==a&&this.use(Q[a])})).searchPipeline=e,w.pipeline=e),{language:a,fields:b.map(function(e){return e.field}).sort()}),x="search-"+j.MD5(P(_)),k=N(b,w,l,f),S={saveAs:x};if(i)return S.destroy=!0,f.query(k,S,c);if(o)delete S.stale,S.limit=0,f.query(k,S).then(function(){c(null,{ok:!0})}).catch(c);else{var E=Array.from(new Set(C(r,w.searchPipeline,!0)));if(!E.length)return c(null,{total_rows:0,rows:[]});S.keys=E.map(function(e){return"a"+e}),"string"==typeof y&&(S.stale=y);var O,A,T=E.filter(function(e){e=e.split("*");return 1<e.length&&0<e.filter(function(e){return 0<e.length}).length});if(0<T.length)return O=0,A={},delete S.keys,f.query(k,S).then(function(e){return e.rows.filter(function(e){var e=e.key.substring(1),t=T[0],r=t.split("*"),n=e;if("*"!==t[0]||"*"!==t[t.length-1]||3!==r.length)return!(2<r.length)&&(t=r[0],e=r[1],t=n.substring(0,t.length)===t,e=n.substring(n.length-e.length)===e,t)&&e;for(var i=r[1],o=!1,s=0,a=n.length-i.length;s<a;s++)if(n.substring(s,s+i.length)===i){o=!0;break}return o})}).then(function(e){return O=e.length,"number"==typeof g&&0<=g?e.slice(v,v+g):0<v?e.slice(v):e}).then(function(e){return p?F(f,e):e}).then(function(e){return d?D(f,u,e,b,A):e}).then(function(e){c(null,{total_rows:O,rows:e})});var L=[];f._query(k,{startkey:"a"+E[E.length-1],endkey:"a"+E[E.length-1]+"",stale:S.stale,saveAs:S.saveAs}).then(function(e){return L=e.rows,f._search_query(k,S)}).then(function(e){for(var t,o,l,r,n=e.rows.map(function(e){return e.key+e.id+e.value}),i=L.map(function(e){return"a"+E[E.length-1]+e.id+e.value}),s=0,a=i.length;s<a;s++)-1===n.indexOf(i[s])&&e.rows.push(L[s]);return e.rows.length&&(t=0,o={},l={},e.rows.forEach(function(e){var t=e.key.substring(1),r=e.value||0;if(t in l?l[t]++:l[t]=1,!(e.id in o))for(var n=o[e.id]=[],i=0;i<b.length;i++)n[i]={};e=o[e.id][r];t in e?e[t]++:e[t]=1}),1<E.length&&Object.keys(o).forEach(function(e){var t={},r=o[e];Object.keys(r).forEach(function(e){Object.keys(r[e]).forEach(function(e){t[e]=!0})});var n=Object.keys(t).length/E.length;Math.floor(100*n)/100<h&&delete o[e]}),Object.keys(o).length)?(r=Object.keys(o).map(function(e){return"b"+e}),r={saveAs:x,_raw_keys:!0,keys:r.map(function(e){return I([e,e.substring(1)])}),stale:y},f.query(k,r).then(function(e){var i,s,a,u,c,t={};return e.rows.forEach(function(e){e.id in t||(t[e.id]=e.value||0)}),i=E,s=l,a=o,u=t,c=b,(e=Object.keys(a).map(function(e){var t=a[e],o=u[e],r=i.map(function(i){return t.map(function(e,t){var r,n=o[t];return i in e?(r=s[i],e[i]/r*(1/r)*c[t].boost/n):0}).reduce(B,0)}),n=0;return r.forEach(function(e){n<e&&(n=e)}),{id:e,score:n}})).sort(function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}),e}).then(function(e){return t=e.length,"number"==typeof g&&0<=g?e.slice(v,v+g):0<v?e.slice(v):e}).then(function(e){return p?F(f,e):e}).then(function(e){return d?D(f,u,e,b,o):e}).then(function(e){c(null,{total_rows:t,rows:e})})):c(null,{total_rows:0,rows:[]})}).catch(c)}}),"undefined"!=typeof PouchDB&&PouchDB.plugin(r)},{1:1,11:11,15:15,19:19,24:24}]},{},[35])(35)});
